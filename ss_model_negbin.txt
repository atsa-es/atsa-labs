
model {  
   # priors on parameters
   u ~ dnorm(0, 0.01); 
   inv.q ~ dgamma(0.001,0.001); 
   q <- 1/inv.q;
   r ~ dunif(0,50);
   X0 ~ dnorm(0, 0.001);
   
   # likelihood
   X[1] ~ dnorm(X0 + u, inv.q);
   log(EY[1]) <- X[1]
   p[1] <- r/(r + EY[1])
   Y[1] ~ dnegbin(p[1], r)
   for(t in 2:N) {
      X[t] ~ dnorm(X[t-1] + u, inv.q);
      log(EY[t]) <- X[t]
      p[t] <- r/(r + EY[t])
      Y[t] ~ dnegbin(p[t], r)
   }
}  
