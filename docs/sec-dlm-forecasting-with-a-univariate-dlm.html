<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.8 Forecasting | Applied Time Series Analysis for Fisheries and Environmental Sciences</title>
  <meta name="description" content="These are the computer labs for Fish 507: Applied Time Series Analysis for Fisheries and Environmental Sciences." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="9.8 Forecasting | Applied Time Series Analysis for Fisheries and Environmental Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="These are the computer labs for Fish 507: Applied Time Series Analysis for Fisheries and Environmental Sciences." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.8 Forecasting | Applied Time Series Analysis for Fisheries and Environmental Sciences" />
  
  <meta name="twitter:description" content="These are the computer labs for Fish 507: Applied Time Series Analysis for Fisheries and Environmental Sciences." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="E. E. Holmes, M. D. Scheuerell, and E. J. Ward" />


<meta name="date" content="2021-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="sec-dlm-fitting-a-univariate-dlm-with-marss.html"/>
<link rel="next" href="sec-dlm-dlm-forecast-diagnostics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Time Series Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-package"><i class="fa fa-check"></i>Book package</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors"><i class="fa fa-check"></i>Authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-basicmat.html"><a href="chap-basicmat.html"><i class="fa fa-check"></i><b>1</b> Basic matrix math in R</a><ul>
<li class="chapter" data-level="1.1" data-path="sec-basicmat-create.html"><a href="sec-basicmat-create.html"><i class="fa fa-check"></i><b>1.1</b> Creating matrices in R</a></li>
<li class="chapter" data-level="1.2" data-path="sec-basicmat-multiply.html"><a href="sec-basicmat-multiply.html"><i class="fa fa-check"></i><b>1.2</b> Matrix multiplication, addition and transpose</a></li>
<li class="chapter" data-level="1.3" data-path="sec-basicmat-subset.html"><a href="sec-basicmat-subset.html"><i class="fa fa-check"></i><b>1.3</b> Subsetting a matrix</a></li>
<li class="chapter" data-level="1.4" data-path="sec-basicmat-replace.html"><a href="sec-basicmat-replace.html"><i class="fa fa-check"></i><b>1.4</b> Replacing elements in a matrix</a></li>
<li class="chapter" data-level="1.5" data-path="sec-basicmat-diagonal.html"><a href="sec-basicmat-diagonal.html"><i class="fa fa-check"></i><b>1.5</b> Diagonal matrices and identity matrices</a></li>
<li class="chapter" data-level="1.6" data-path="sec-basicmat-inverse.html"><a href="sec-basicmat-inverse.html"><i class="fa fa-check"></i><b>1.6</b> Taking the inverse of a square matrix</a></li>
<li class="chapter" data-level="1.7" data-path="sec-basicmat-problems.html"><a href="sec-basicmat-problems.html"><i class="fa fa-check"></i><b>1.7</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-mlr.html"><a href="chap-mlr.html"><i class="fa fa-check"></i><b>2</b> Linear regression in matrix form</a><ul>
<li class="chapter" data-level="" data-path="chap-mlr.html"><a href="chap-mlr.html#data-and-packages"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="2.1" data-path="sec-mlr-lr1.html"><a href="sec-mlr-lr1.html"><i class="fa fa-check"></i><b>2.1</b> A simple regression: one explanatory variable</a></li>
<li class="chapter" data-level="2.2" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html"><i class="fa fa-check"></i><b>2.2</b> Matrix Form 1</a><ul>
<li class="chapter" data-level="2.2.1" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-solveform1"><i class="fa fa-check"></i><b>2.2.1</b> Solving for the parameters</a></li>
<li class="chapter" data-level="2.2.2" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-form1m"><i class="fa fa-check"></i><b>2.2.2</b> Form 1 with multiple explanatory variables</a></li>
<li class="chapter" data-level="2.2.3" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-form1when"><i class="fa fa-check"></i><b>2.2.3</b> When does Form 1 arise?</a></li>
<li class="chapter" data-level="2.2.4" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-form1b"><i class="fa fa-check"></i><b>2.2.4</b> Matrix Form 1b: The transpose of Form 1</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sec-mlr-form2.html"><a href="sec-mlr-form2.html"><i class="fa fa-check"></i><b>2.3</b> Matrix Form 2</a><ul>
<li class="chapter" data-level="2.3.1" data-path="sec-mlr-form2.html"><a href="sec-mlr-form2.html#sec-mlr-form2m"><i class="fa fa-check"></i><b>2.3.1</b> Form 2 with multiple explanatory variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="sec-mlr-form2.html"><a href="sec-mlr-form2.html#sec-mlr-form2when"><i class="fa fa-check"></i><b>2.3.2</b> When does Form 2 arise?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sec-mlr-intercepts.html"><a href="sec-mlr-intercepts.html"><i class="fa fa-check"></i><b>2.4</b> Groups of intercepts</a><ul>
<li class="chapter" data-level="2.4.1" data-path="sec-mlr-intercepts.html"><a href="sec-mlr-intercepts.html#sec-mlr-intercepts-form1"><i class="fa fa-check"></i><b>2.4.1</b> North/South intercepts in Form 1</a></li>
<li class="chapter" data-level="2.4.2" data-path="sec-mlr-intercepts.html"><a href="sec-mlr-intercepts.html#sec-mlr-intercepts-form2"><i class="fa fa-check"></i><b>2.4.2</b> North/South intercepts in Form 2</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sec-mlr-betas.html"><a href="sec-mlr-betas.html"><i class="fa fa-check"></i><b>2.5</b> Groups of <span class="math inline">\(\beta\)</span>’s</a><ul>
<li class="chapter" data-level="2.5.1" data-path="sec-mlr-betas.html"><a href="sec-mlr-betas.html#sec-mlr-betas-form1"><i class="fa fa-check"></i><b>2.5.1</b> Owner <span class="math inline">\(\beta\)</span>’s in Form 1</a></li>
<li class="chapter" data-level="2.5.2" data-path="sec-mlr-betas.html"><a href="sec-mlr-betas.html#sec-mlr-betas-form2"><i class="fa fa-check"></i><b>2.5.2</b> Owner <span class="math inline">\(\beta\)</span>’s in Form 2</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sec-mlr-season-factor.html"><a href="sec-mlr-season-factor.html"><i class="fa fa-check"></i><b>2.6</b> Seasonal effect as a factor</a><ul>
<li class="chapter" data-level="2.6.1" data-path="sec-mlr-season-factor.html"><a href="sec-mlr-season-factor.html#sec-mlr-season-form1"><i class="fa fa-check"></i><b>2.6.1</b> Seasonal intercepts written in Form 1</a></li>
<li class="chapter" data-level="2.6.2" data-path="sec-mlr-season-factor.html"><a href="sec-mlr-season-factor.html#sec-mlr-season-form2"><i class="fa fa-check"></i><b>2.6.2</b> Seasonal intercepts written in Form 2</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sec-mlr-season-w-var.html"><a href="sec-mlr-season-w-var.html"><i class="fa fa-check"></i><b>2.7</b> Seasonal effect plus other explanatory variables*</a></li>
<li class="chapter" data-level="2.8" data-path="sec-mlr-confound.html"><a href="sec-mlr-confound.html"><i class="fa fa-check"></i><b>2.8</b> Models with confounded parameters*</a></li>
<li class="chapter" data-level="2.9" data-path="sec-mlr-solveform2.html"><a href="sec-mlr-solveform2.html"><i class="fa fa-check"></i><b>2.9</b> Solving for the parameters for Form 2*</a></li>
<li class="chapter" data-level="2.10" data-path="sec-mlr-problems.html"><a href="sec-mlr-problems.html"><i class="fa fa-check"></i><b>2.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-ts.html"><a href="chap-ts.html"><i class="fa fa-check"></i><b>3</b> Introduction to time series</a><ul>
<li class="chapter" data-level="3.1" data-path="sec-ts-examples.html"><a href="sec-ts-examples.html"><i class="fa fa-check"></i><b>3.1</b> Examples of time series</a></li>
<li class="chapter" data-level="3.2" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html"><i class="fa fa-check"></i><b>3.2</b> Classification of time series</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-some-index-set"><i class="fa fa-check"></i><b>3.2.1</b> By some <em>index set</em></a></li>
<li class="chapter" data-level="3.2.2" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-the-underlying-process"><i class="fa fa-check"></i><b>3.2.2</b> By the <em>underlying process</em></a></li>
<li class="chapter" data-level="3.2.3" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-the-number-of-values-recorded"><i class="fa fa-check"></i><b>3.2.3</b> By the <em>number of values recorded</em></a></li>
<li class="chapter" data-level="3.2.4" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-the-type-of-values-recorded"><i class="fa fa-check"></i><b>3.2.4</b> By the <em>type of values recorded</em></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sec-ts-stat-analysis.html"><a href="sec-ts-stat-analysis.html"><i class="fa fa-check"></i><b>3.3</b> Statistical analyses of time series</a></li>
<li class="chapter" data-level="3.4" data-path="sec-ts-definition.html"><a href="sec-ts-definition.html"><i class="fa fa-check"></i><b>3.4</b> What is a time series model?</a></li>
<li class="chapter" data-level="3.5" data-path="sec-ts-two-examples.html"><a href="sec-ts-two-examples.html"><i class="fa fa-check"></i><b>3.5</b> Two simple and classic time series models</a></li>
<li class="chapter" data-level="3.6" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html"><i class="fa fa-check"></i><b>3.6</b> Classical decomposition</a><ul>
<li class="chapter" data-level="3.6.1" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#the-trend-m_t"><i class="fa fa-check"></i><b>3.6.1</b> 1. The trend (<span class="math inline">\(m_t\)</span>)</a></li>
<li class="chapter" data-level="3.6.2" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#example-of-linear-filtering"><i class="fa fa-check"></i><b>3.6.2</b> Example of linear filtering</a></li>
<li class="chapter" data-level="3.6.3" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#seasonal-effect-s_t"><i class="fa fa-check"></i><b>3.6.3</b> 2. Seasonal effect (<span class="math inline">\(s_t\)</span>)</a></li>
<li class="chapter" data-level="3.6.4" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#remainder-e_t"><i class="fa fa-check"></i><b>3.6.4</b> 3. Remainder (<span class="math inline">\(e_t\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html"><i class="fa fa-check"></i><b>3.7</b> Decomposition on log-transformed data</a><ul>
<li class="chapter" data-level="3.7.1" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#the-trend-m_t-1"><i class="fa fa-check"></i><b>3.7.1</b> The trend (<span class="math inline">\(m_t\)</span>)</a></li>
<li class="chapter" data-level="3.7.2" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#seasonal-effect-s_t-with-error-e_t"><i class="fa fa-check"></i><b>3.7.2</b> Seasonal effect (<span class="math inline">\(s_t\)</span>) with error (<span class="math inline">\(e_t\)</span>)</a></li>
<li class="chapter" data-level="3.7.3" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#mean-seasonal-effect-s_t"><i class="fa fa-check"></i><b>3.7.3</b> Mean seasonal effect (<span class="math inline">\(s_t\)</span>)</a></li>
<li class="chapter" data-level="3.7.4" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#remainder-e_t-1"><i class="fa fa-check"></i><b>3.7.4</b> Remainder (<span class="math inline">\(e_t\)</span>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-tslab.html"><a href="chap-tslab.html"><i class="fa fa-check"></i><b>4</b> Basic time series functions in R</a><ul>
<li class="chapter" data-level="" data-path="chap-tslab.html"><a href="chap-tslab.html#data-and-packages-1"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="4.1" data-path="sec-tslab-time-series-plots.html"><a href="sec-tslab-time-series-plots.html"><i class="fa fa-check"></i><b>4.1</b> Time series plots</a><ul>
<li class="chapter" data-level="4.1.1" data-path="sec-tslab-time-series-plots.html"><a href="sec-tslab-time-series-plots.html#sec-tslab-textbfts-objects-and-verbplotts"><i class="fa fa-check"></i><b>4.1.1</b> <strong>ts</strong> objects and <code>plot.ts()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="sec-tslab-time-series-plots.html"><a href="sec-tslab-time-series-plots.html#sec-tslab-combining-and-plotting-multiple-textbfts-objects"><i class="fa fa-check"></i><b>4.1.2</b> Combining and plotting multiple <strong>ts</strong> objects</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html"><i class="fa fa-check"></i><b>4.2</b> Decomposition of time series</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-estimating-trends"><i class="fa fa-check"></i><b>4.2.1</b> Estimating trends</a></li>
<li class="chapter" data-level="4.2.2" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-estimating-seasonal-effects"><i class="fa fa-check"></i><b>4.2.2</b> Estimating seasonal effects</a></li>
<li class="chapter" data-level="4.2.3" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-completing-the-model"><i class="fa fa-check"></i><b>4.2.3</b> Completing the model</a></li>
<li class="chapter" data-level="4.2.4" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-using-verbdecompose-for-decomposition"><i class="fa fa-check"></i><b>4.2.4</b> Using <code>decompose()</code> for decomposition</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html"><a href="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html"><i class="fa fa-check"></i><b>4.3</b> Differencing to remove a trend or seasonal effects</a><ul>
<li class="chapter" data-level="4.3.1" data-path="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html"><a href="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html#sec-tslab-using-the-verbdiff-function"><i class="fa fa-check"></i><b>4.3.1</b> Using the <code>diff()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html"><i class="fa fa-check"></i><b>4.4</b> Correlation within and among time series</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html#sec-tslab-autocorrelation-function-acf"><i class="fa fa-check"></i><b>4.4.1</b> Autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="4.4.2" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html#sec-tslab-partial-autocorrelation-function-pacf"><i class="fa fa-check"></i><b>4.4.2</b> Partial autocorrelation function (PACF)</a></li>
<li class="chapter" data-level="4.4.3" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html#sec-tslab-cross-correlation-function-ccf"><i class="fa fa-check"></i><b>4.4.3</b> Cross-correlation function (CCF)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sec-tslab-white-noise-wn.html"><a href="sec-tslab-white-noise-wn.html"><i class="fa fa-check"></i><b>4.5</b> White noise (WN)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="sec-tslab-white-noise-wn.html"><a href="sec-tslab-white-noise-wn.html#sec-tslab-simulating-white-noise"><i class="fa fa-check"></i><b>4.5.1</b> Simulating white noise</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="sec-tslab-random-walks-rw.html"><a href="sec-tslab-random-walks-rw.html"><i class="fa fa-check"></i><b>4.6</b> Random walks (RW)</a><ul>
<li class="chapter" data-level="4.6.1" data-path="sec-tslab-random-walks-rw.html"><a href="sec-tslab-random-walks-rw.html#sec-tslab-simulating-a-random-walk"><i class="fa fa-check"></i><b>4.6.1</b> Simulating a random walk</a></li>
<li class="chapter" data-level="4.6.2" data-path="sec-tslab-random-walks-rw.html"><a href="sec-tslab-random-walks-rw.html#sec-tslab-alternative-formulation-of-a-random-walk"><i class="fa fa-check"></i><b>4.6.2</b> Alternative formulation of a random walk</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="sec-tslab-autoregressive-ar-models.html"><a href="sec-tslab-autoregressive-ar-models.html"><i class="fa fa-check"></i><b>4.7</b> Autoregressive (AR) models</a><ul>
<li class="chapter" data-level="4.7.1" data-path="sec-tslab-autoregressive-ar-models.html"><a href="sec-tslab-autoregressive-ar-models.html#sec-tslab-simulating-an-AR_p_coef-process"><i class="fa fa-check"></i><b>4.7.1</b> Simulating an AR(<span class="math inline">\(p\)</span>) process</a></li>
<li class="chapter" data-level="4.7.2" data-path="sec-tslab-autoregressive-ar-models.html"><a href="sec-tslab-autoregressive-ar-models.html#sec-tslab-correlation-structure-of-AR_p_coef-processes"><i class="fa fa-check"></i><b>4.7.2</b> Correlation structure of AR(<span class="math inline">\(p\)</span>) processes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="sec-tslab-moving-average-ma-models.html"><a href="sec-tslab-moving-average-ma-models.html"><i class="fa fa-check"></i><b>4.8</b> Moving-average (MA) models</a><ul>
<li class="chapter" data-level="4.8.1" data-path="sec-tslab-moving-average-ma-models.html"><a href="sec-tslab-moving-average-ma-models.html#sec-tslab-simulating-an-MA_q_coef-process"><i class="fa fa-check"></i><b>4.8.1</b> Simulating an MA(<span class="math inline">\(q\)</span>) process</a></li>
<li class="chapter" data-level="4.8.2" data-path="sec-tslab-moving-average-ma-models.html"><a href="sec-tslab-moving-average-ma-models.html#sec-tslab-correlation-structure-of-MA_q_coef-processes"><i class="fa fa-check"></i><b>4.8.2</b> Correlation structure of MA(<span class="math inline">\(q\)</span>) processes</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="sec-tslab-autoregressive-moving-average-arma-models.html"><a href="sec-tslab-autoregressive-moving-average-arma-models.html"><i class="fa fa-check"></i><b>4.9</b> Autoregressive moving-average (ARMA) models</a><ul>
<li class="chapter" data-level="4.9.1" data-path="sec-tslab-autoregressive-moving-average-arma-models.html"><a href="sec-tslab-autoregressive-moving-average-arma-models.html#sec-tslab-fitting-armapq-models-with-verbarima"><i class="fa fa-check"></i><b>4.9.1</b> Fitting ARMA(<span class="math inline">\(p,q\)</span>) models with <code>arima()</code></a></li>
<li class="chapter" data-level="4.9.2" data-path="sec-tslab-autoregressive-moving-average-arma-models.html"><a href="sec-tslab-autoregressive-moving-average-arma-models.html#sec-tslab-searching-over-model-orders"><i class="fa fa-check"></i><b>4.9.2</b> Searching over model orders</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="sec-tslab-problems.html"><a href="sec-tslab-problems.html"><i class="fa fa-check"></i><b>4.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-boxjenkins-.html"><a href="chap-boxjenkins-.html"><i class="fa fa-check"></i><b>5</b> Box-Jenkins method</a><ul>
<li class="chapter" data-level="" data-path="chap-boxjenkins-.html"><a href="chap-boxjenkins-.html#data-and-packages-2"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="5.1" data-path="sec-boxjenkins-intro.html"><a href="sec-boxjenkins-intro.html"><i class="fa fa-check"></i><b>5.1</b> Box-Jenkins method</a></li>
<li class="chapter" data-level="5.2" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html"><i class="fa fa-check"></i><b>5.2</b> Stationarity</a><ul>
<li class="chapter" data-level="5.2.1" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html#look-at-stationarity-in-simulated-data"><i class="fa fa-check"></i><b>5.2.1</b> Look at stationarity in simulated data</a></li>
<li class="chapter" data-level="5.2.2" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html#stationary-around-a-linear-trend"><i class="fa fa-check"></i><b>5.2.2</b> Stationary around a linear trend</a></li>
<li class="chapter" data-level="5.2.3" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html#greek-landing-data"><i class="fa fa-check"></i><b>5.2.3</b> Greek landing data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html"><i class="fa fa-check"></i><b>5.3</b> Dickey-Fuller and Augmented Dickey-Fuller tests</a><ul>
<li class="chapter" data-level="5.3.1" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#dickey-fuller-test"><i class="fa fa-check"></i><b>5.3.1</b> Dickey-Fuller test</a></li>
<li class="chapter" data-level="5.3.2" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#augmented-dickey-fuller-test"><i class="fa fa-check"></i><b>5.3.2</b> Augmented Dickey-Fuller test</a></li>
<li class="chapter" data-level="5.3.3" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#adf-test-using-adf.test"><i class="fa fa-check"></i><b>5.3.3</b> ADF test using <code>adf.test()</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#adf-test-using-ur.df"><i class="fa fa-check"></i><b>5.3.4</b> ADF test using <code>ur.df()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sec-boxjenkins-kpss.html"><a href="sec-boxjenkins-kpss.html"><i class="fa fa-check"></i><b>5.4</b> KPSS test</a><ul>
<li class="chapter" data-level="5.4.1" data-path="sec-boxjenkins-kpss.html"><a href="sec-boxjenkins-kpss.html#test-on-simulated-data"><i class="fa fa-check"></i><b>5.4.1</b> Test on simulated data</a></li>
<li class="chapter" data-level="5.4.2" data-path="sec-boxjenkins-kpss.html"><a href="sec-boxjenkins-kpss.html#test-the-anchovy-data-1"><i class="fa fa-check"></i><b>5.4.2</b> Test the anchovy data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sec-boxjenkins-non-stationarity.html"><a href="sec-boxjenkins-non-stationarity.html"><i class="fa fa-check"></i><b>5.5</b> Dealing with non-stationarity</a><ul>
<li class="chapter" data-level="5.5.1" data-path="sec-boxjenkins-non-stationarity.html"><a href="sec-boxjenkins-non-stationarity.html#ndiffs"><i class="fa fa-check"></i><b>5.5.1</b> <code>ndiffs()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="sec-boxjenkins-stationarity-summary.html"><a href="sec-boxjenkins-stationarity-summary.html"><i class="fa fa-check"></i><b>5.6</b> Summary: stationarity testing</a></li>
<li class="chapter" data-level="5.7" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html"><i class="fa fa-check"></i><b>5.7</b> Estimating ARMA parameters</a><ul>
<li class="chapter" data-level="5.7.1" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#ar2-data"><i class="fa fa-check"></i><b>5.7.1</b> AR(2) data</a></li>
<li class="chapter" data-level="5.7.2" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#fit-with-arima"><i class="fa fa-check"></i><b>5.7.2</b> Fit with <code>Arima()</code></a></li>
<li class="chapter" data-level="5.7.3" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#ar1-simulated-data"><i class="fa fa-check"></i><b>5.7.3</b> AR(1) simulated data</a></li>
<li class="chapter" data-level="5.7.4" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#arma12-simulated-data"><i class="fa fa-check"></i><b>5.7.4</b> ARMA(1,2) simulated data</a></li>
<li class="chapter" data-level="5.7.5" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#these-functions-work-for-data-with-missing-values"><i class="fa fa-check"></i><b>5.7.5</b> These functions work for data with missing values</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html"><i class="fa fa-check"></i><b>5.8</b> Estimating the ARMA orders</a><ul>
<li class="chapter" data-level="5.8.1" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#example-model-selection-for-ar2-data"><i class="fa fa-check"></i><b>5.8.1</b> Example: model selection for AR(2) data</a></li>
<li class="chapter" data-level="5.8.2" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#fitting-to-100-simulated-data-sets"><i class="fa fa-check"></i><b>5.8.2</b> Fitting to 100 simulated data sets</a></li>
<li class="chapter" data-level="5.8.3" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#tracetrue"><i class="fa fa-check"></i><b>5.8.3</b> Trace=TRUE</a></li>
<li class="chapter" data-level="5.8.4" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#stepwisefalse"><i class="fa fa-check"></i><b>5.8.4</b> stepwise=FALSE</a></li>
<li class="chapter" data-level="5.8.5" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#fit-to-the-anchovy-data"><i class="fa fa-check"></i><b>5.8.5</b> Fit to the anchovy data</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="sec-boxjenkins-check-resids.html"><a href="sec-boxjenkins-check-resids.html"><i class="fa fa-check"></i><b>5.9</b> Check residuals</a></li>
<li class="chapter" data-level="5.10" data-path="sec-boxjenkins-forecast.html"><a href="sec-boxjenkins-forecast.html"><i class="fa fa-check"></i><b>5.10</b> Forecast from a fitted ARIMA model</a></li>
<li class="chapter" data-level="5.11" data-path="sec-boxjenkins-seasonal.html"><a href="sec-boxjenkins-seasonal.html"><i class="fa fa-check"></i><b>5.11</b> Seasonal ARIMA model</a><ul>
<li class="chapter" data-level="5.11.1" data-path="sec-boxjenkins-seasonal.html"><a href="sec-boxjenkins-seasonal.html#plot-seasonal-data"><i class="fa fa-check"></i><b>5.11.1</b> Plot seasonal data</a></li>
<li class="chapter" data-level="5.11.2" data-path="sec-boxjenkins-seasonal.html"><a href="sec-boxjenkins-seasonal.html#auto.arima-for-seasonal-ts"><i class="fa fa-check"></i><b>5.11.2</b> <code>auto.arima()</code> for seasonal ts</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="sec-boxjenkins-forecast-seasonal.html"><a href="sec-boxjenkins-forecast-seasonal.html"><i class="fa fa-check"></i><b>5.12</b> Forecast using a seasonal model</a></li>
<li class="chapter" data-level="5.13" data-path="sec-boxjenkins-problems.html"><a href="sec-boxjenkins-problems.html"><i class="fa fa-check"></i><b>5.13</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-univariate-state-space.html"><a href="chap-univariate-state-space.html"><i class="fa fa-check"></i><b>6</b> Univariate state-space models</a><ul>
<li class="chapter" data-level="" data-path="chap-univariate-state-space.html"><a href="chap-univariate-state-space.html#data-and-packages-3"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="6.1" data-path="sec-uss-fitting-a-state-space-model-with-marss.html"><a href="sec-uss-fitting-a-state-space-model-with-marss.html"><i class="fa fa-check"></i><b>6.1</b> Fitting a state-space model with MARSS</a></li>
<li class="chapter" data-level="6.2" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html"><i class="fa fa-check"></i><b>6.2</b> Examples using the Nile river data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-flat-level-model"><i class="fa fa-check"></i><b>6.2.1</b> Flat level model</a></li>
<li class="chapter" data-level="6.2.2" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-linear-trend-in-flow-model"><i class="fa fa-check"></i><b>6.2.2</b> Linear trend in flow model</a></li>
<li class="chapter" data-level="6.2.3" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-stochastic-level-model"><i class="fa fa-check"></i><b>6.2.3</b> Stochastic level model</a></li>
<li class="chapter" data-level="6.2.4" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-stochastic-level-model-with-drift"><i class="fa fa-check"></i><b>6.2.4</b> Stochastic level model with drift</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sec-uss-the-structts-function.html"><a href="sec-uss-the-structts-function.html"><i class="fa fa-check"></i><b>6.3</b> The StructTS function</a></li>
<li class="chapter" data-level="6.4" data-path="sec-uss-comparing-models-with-aic-and-model-weights.html"><a href="sec-uss-comparing-models-with-aic-and-model-weights.html"><i class="fa fa-check"></i><b>6.4</b> Comparing models with AIC and model weights</a></li>
<li class="chapter" data-level="6.5" data-path="sec-uss-basic-diagnostics.html"><a href="sec-uss-basic-diagnostics.html"><i class="fa fa-check"></i><b>6.5</b> Basic diagnostics</a><ul>
<li class="chapter" data-level="6.5.1" data-path="sec-uss-basic-diagnostics.html"><a href="sec-uss-basic-diagnostics.html#sec-uss-more-diagnostics"><i class="fa fa-check"></i><b>6.5.1</b> Outlier diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="sec-uss-fitting-with-jags.html"><a href="sec-uss-fitting-with-jags.html"><i class="fa fa-check"></i><b>6.6</b> Fitting with JAGS</a></li>
<li class="chapter" data-level="6.7" data-path="sec-uss-fitting-with-stan.html"><a href="sec-uss-fitting-with-stan.html"><i class="fa fa-check"></i><b>6.7</b> Fitting with Stan</a></li>
<li class="chapter" data-level="6.8" data-path="sec-uss-a-simple-random-walk-model-of-animal-movement.html"><a href="sec-uss-a-simple-random-walk-model-of-animal-movement.html"><i class="fa fa-check"></i><b>6.8</b> A random walk model of animal movement</a></li>
<li class="chapter" data-level="6.9" data-path="sec-uss-problems.html"><a href="sec-uss-problems.html"><i class="fa fa-check"></i><b>6.9</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap-mss.html"><a href="chap-mss.html"><i class="fa fa-check"></i><b>7</b> MARSS models</a><ul>
<li class="chapter" data-level="" data-path="chap-mss.html"><a href="chap-mss.html#data-and-packages-4"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="7.1" data-path="sec-mss-overview.html"><a href="sec-mss-overview.html"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="sec-mss-west-coast-harbor-seals-counts.html"><a href="sec-mss-west-coast-harbor-seals-counts.html"><i class="fa fa-check"></i><b>7.2</b> West coast harbor seals counts</a><ul>
<li class="chapter" data-level="7.2.1" data-path="sec-mss-west-coast-harbor-seals-counts.html"><a href="sec-mss-west-coast-harbor-seals-counts.html#sec-mss-load-the-harbor-seal-data"><i class="fa fa-check"></i><b>7.2.1</b> Load the harbor seal data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html"><i class="fa fa-check"></i><b>7.3</b> A single well-mixed population</a><ul>
<li class="chapter" data-level="7.3.1" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html#sec-mss-the-observation-process"><i class="fa fa-check"></i><b>7.3.1</b> The observation process</a></li>
<li class="chapter" data-level="7.3.2" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html#sec-mss-fitting-the-model"><i class="fa fa-check"></i><b>7.3.2</b> Fitting the model</a></li>
<li class="chapter" data-level="7.3.3" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html#sec-mss-model-residuals"><i class="fa fa-check"></i><b>7.3.3</b> Model residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sec-mss-segind.html"><a href="sec-mss-segind.html"><i class="fa fa-check"></i><b>7.4</b> Four subpopulations with temporally uncorrelated errors</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sec-mss-segind.html"><a href="sec-mss-segind.html#sec-mss-the-observation-process-2"><i class="fa fa-check"></i><b>7.4.1</b> The observation process</a></li>
<li class="chapter" data-level="7.4.2" data-path="sec-mss-segind.html"><a href="sec-mss-segind.html#sec-mss-fitting-mod1"><i class="fa fa-check"></i><b>7.4.2</b> Fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><a href="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><i class="fa fa-check"></i><b>7.5</b> Four subpopulations with temporally correlated errors</a><ul>
<li class="chapter" data-level="7.5.1" data-path="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><a href="sec-mss-four-subpopulations-with-temporally-correlated-errors.html#sec-mss-fitting-mod2"><i class="fa fa-check"></i><b>7.5.1</b> Fitting the model</a></li>
<li class="chapter" data-level="7.5.2" data-path="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><a href="sec-mss-four-subpopulations-with-temporally-correlated-errors.html#sec-mss-residuals-mod2"><i class="fa fa-check"></i><b>7.5.2</b> Model residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sec-mss-using-marss-models-to-study-spatial-structure.html"><a href="sec-mss-using-marss-models-to-study-spatial-structure.html"><i class="fa fa-check"></i><b>7.6</b> Using MARSS models to study spatial structure</a></li>
<li class="chapter" data-level="7.7" data-path="sec-mss-hypotheses-regarding-spatial-structure.html"><a href="sec-mss-hypotheses-regarding-spatial-structure.html"><i class="fa fa-check"></i><b>7.7</b> Hypotheses regarding spatial structure</a></li>
<li class="chapter" data-level="7.8" data-path="sec-mss-set-up-the-hypotheses-as-different-models.html"><a href="sec-mss-set-up-the-hypotheses-as-different-models.html"><i class="fa fa-check"></i><b>7.8</b> Set up the hypotheses as different models</a><ul>
<li class="chapter" data-level="7.8.1" data-path="sec-mss-set-up-the-hypotheses-as-different-models.html"><a href="sec-mss-set-up-the-hypotheses-as-different-models.html#sec-fit-models-hyp"><i class="fa fa-check"></i><b>7.8.1</b> Fit the models</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html"><i class="fa fa-check"></i><b>7.9</b> Fitting a MARSS model with JAGS</a><ul>
<li class="chapter" data-level="7.9.1" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html#sec-mss-writing-the-model-in-jags"><i class="fa fa-check"></i><b>7.9.1</b> Writing the model in JAGS</a></li>
<li class="chapter" data-level="7.9.2" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html#fit-the-jags-model"><i class="fa fa-check"></i><b>7.9.2</b> Fit the JAGS model</a></li>
<li class="chapter" data-level="7.9.3" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html#sec-mss-plot-the-posteriors-for-the-estimated-states"><i class="fa fa-check"></i><b>7.9.3</b> Plot the posteriors for the estimated states</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="sec-marss-fitting-with-stan.html"><a href="sec-marss-fitting-with-stan.html"><i class="fa fa-check"></i><b>7.10</b> Fitting a MARSS model with Stan</a></li>
<li class="chapter" data-level="7.11" data-path="sec-mss-problems.html"><a href="sec-mss-problems.html"><i class="fa fa-check"></i><b>7.11</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap-msscov.html"><a href="chap-msscov.html"><i class="fa fa-check"></i><b>8</b> MARSS models with covariates</a><ul>
<li class="chapter" data-level="" data-path="chap-msscov.html"><a href="chap-msscov.html#data-and-packages-5"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="8.1" data-path="sec-msscov-overview.html"><a href="sec-msscov-overview.html"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="sec-msscov-prepare-data.html"><a href="sec-msscov-prepare-data.html"><i class="fa fa-check"></i><b>8.2</b> Prepare the plankton data</a></li>
<li class="chapter" data-level="8.3" data-path="sec-msscov-obs-error-only.html"><a href="sec-msscov-obs-error-only.html"><i class="fa fa-check"></i><b>8.3</b> Observation-error only model</a></li>
<li class="chapter" data-level="8.4" data-path="sec-msscov-proc-error-only.html"><a href="sec-msscov-proc-error-only.html"><i class="fa fa-check"></i><b>8.4</b> Process-error only model</a></li>
<li class="chapter" data-level="8.5" data-path="sec-msscov-both-error.html"><a href="sec-msscov-both-error.html"><i class="fa fa-check"></i><b>8.5</b> Both process- and observation-error</a></li>
<li class="chapter" data-level="8.6" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html"><i class="fa fa-check"></i><b>8.6</b> Including seasonal effects in MARSS models</a><ul>
<li class="chapter" data-level="8.6.1" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html#sec-msscov-season-factors"><i class="fa fa-check"></i><b>8.6.1</b> Seasonal effects as fixed factors</a></li>
<li class="chapter" data-level="8.6.2" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html#sec-msscov-season-polynomial"><i class="fa fa-check"></i><b>8.6.2</b> Seasonal effects as a polynomial</a></li>
<li class="chapter" data-level="8.6.3" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html#sec-msscov-season-fourier"><i class="fa fa-check"></i><b>8.6.3</b> Seasonal effects as a Fourier series</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="sec-msscov-model-diagnostics.html"><a href="sec-msscov-model-diagnostics.html"><i class="fa fa-check"></i><b>8.7</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.8" data-path="sec-msscov-hw-discussion.html"><a href="sec-msscov-hw-discussion.html"><i class="fa fa-check"></i><b>8.8</b> Homework data and discussion</a></li>
<li class="chapter" data-level="8.9" data-path="sec-msscov-problems.html"><a href="sec-msscov-problems.html"><i class="fa fa-check"></i><b>8.9</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap-dlm-dynamic-linear-models.html"><a href="chap-dlm-dynamic-linear-models.html"><i class="fa fa-check"></i><b>9</b> Dynamic linear models</a><ul>
<li class="chapter" data-level="" data-path="chap-dlm-dynamic-linear-models.html"><a href="chap-dlm-dynamic-linear-models.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="9.1" data-path="sec-dlm-overview.html"><a href="sec-dlm-overview.html"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="sec-dlm-state-space-form.html"><a href="sec-dlm-state-space-form.html"><i class="fa fa-check"></i><b>9.2</b> DLM in state-space form</a></li>
<li class="chapter" data-level="9.3" data-path="sec-dlm-simple-examples.html"><a href="sec-dlm-simple-examples.html"><i class="fa fa-check"></i><b>9.3</b> Stochastic level models</a><ul>
<li class="chapter" data-level="9.3.1" data-path="sec-dlm-simple-examples.html"><a href="sec-dlm-simple-examples.html#stochastic-level-with-drift"><i class="fa fa-check"></i><b>9.3.1</b> Stochastic level with drift</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sec-dlm-regression.html"><a href="sec-dlm-regression.html"><i class="fa fa-check"></i><b>9.4</b> Stochastic regression model</a></li>
<li class="chapter" data-level="9.5" data-path="sec-dlm-with-season.html"><a href="sec-dlm-with-season.html"><i class="fa fa-check"></i><b>9.5</b> DLM with seasonal effect</a></li>
<li class="chapter" data-level="9.6" data-path="sec-dlm-salmon-example.html"><a href="sec-dlm-salmon-example.html"><i class="fa fa-check"></i><b>9.6</b> Analysis of salmon survival</a></li>
<li class="chapter" data-level="9.7" data-path="sec-dlm-fitting-a-univariate-dlm-with-marss.html"><a href="sec-dlm-fitting-a-univariate-dlm-with-marss.html"><i class="fa fa-check"></i><b>9.7</b> Fitting with <code>MARSS()</code></a></li>
<li class="chapter" data-level="9.8" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a><ul>
<li class="chapter" data-level="9.8.1" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#estimate-of-the-regression-parameters"><i class="fa fa-check"></i><b>9.8.1</b> Estimate of the regression parameters</a></li>
<li class="chapter" data-level="9.8.2" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#prediction-of-the-response-variable-y_t"><i class="fa fa-check"></i><b>9.8.2</b> Prediction of the response variable <span class="math inline">\(y_t\)</span></a></li>
<li class="chapter" data-level="9.8.3" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#computing-the-prediction"><i class="fa fa-check"></i><b>9.8.3</b> Computing the prediction</a></li>
<li class="chapter" data-level="9.8.4" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#forecasting-salmon-survival"><i class="fa fa-check"></i><b>9.8.4</b> Forecasting salmon survival</a></li>
<li class="chapter" data-level="9.8.5" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#sec-dlm-forecasting-a-univariate-dlm-with-marss"><i class="fa fa-check"></i><b>9.8.5</b> Forecasting using MARSS</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="sec-dlm-dlm-forecast-diagnostics.html"><a href="sec-dlm-dlm-forecast-diagnostics.html"><i class="fa fa-check"></i><b>9.9</b> Forecast diagnostics</a></li>
<li class="chapter" data-level="9.10" data-path="sec-dlm-homework.html"><a href="sec-dlm-homework.html"><i class="fa fa-check"></i><b>9.10</b> Homework discussion and data</a><ul>
<li class="chapter" data-level="9.10.1" data-path="sec-dlm-homework.html"><a href="sec-dlm-homework.html#sec-dlm-spawner-recruit-data"><i class="fa fa-check"></i><b>9.10.1</b> Spawner-recruit data</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="sec-dlm-problems.html"><a href="sec-dlm-problems.html"><i class="fa fa-check"></i><b>9.11</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-dfa.html"><a href="sec-dfa.html"><i class="fa fa-check"></i><b>10</b> Dynamic Factor Analysis</a><ul>
<li class="chapter" data-level="" data-path="sec-dfa.html"><a href="sec-dfa.html#data-and-packages-6"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="10.1" data-path="sec-dfa-intro.html"><a href="sec-dfa-intro.html"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="sec-dfa-example1.html"><a href="sec-dfa-example1.html"><i class="fa fa-check"></i><b>10.2</b> Example of a DFA model</a></li>
<li class="chapter" data-level="10.3" data-path="sec-dfa-constraining-a-dfa-model.html"><a href="sec-dfa-constraining-a-dfa-model.html"><i class="fa fa-check"></i><b>10.3</b> Constraining a DFA model</a></li>
<li class="chapter" data-level="10.4" data-path="sec-dfa-different-error-structures.html"><a href="sec-dfa-different-error-structures.html"><i class="fa fa-check"></i><b>10.4</b> Different error structures</a></li>
<li class="chapter" data-level="10.5" data-path="sec-dfa-lake-wa-data.html"><a href="sec-dfa-lake-wa-data.html"><i class="fa fa-check"></i><b>10.5</b> Lake Washington phytoplankton data</a><ul>
<li class="chapter" data-level="10.5.1" data-path="sec-dfa-lake-wa-data.html"><a href="sec-dfa-lake-wa-data.html#sec-dfa-plot-lake-wa-data"><i class="fa fa-check"></i><b>10.5.1</b> Plots of the data</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html"><i class="fa fa-check"></i><b>10.6</b> Fitting DFA models with the MARSS package</a><ul>
<li class="chapter" data-level="10.6.1" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html#sec-dfa-observation-model"><i class="fa fa-check"></i><b>10.6.1</b> The observation model</a></li>
<li class="chapter" data-level="10.6.2" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html#sec-dfa-process-model"><i class="fa fa-check"></i><b>10.6.2</b> The process model</a></li>
<li class="chapter" data-level="10.6.3" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html#sec-dfa-fit-model-in-marss"><i class="fa fa-check"></i><b>10.6.3</b> Fit the model in MARSS</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sec-dfa-interpreting-the-marss-output.html"><a href="sec-dfa-interpreting-the-marss-output.html"><i class="fa fa-check"></i><b>10.7</b> Interpreting the MARSS output</a></li>
<li class="chapter" data-level="10.8" data-path="sec-dfa-rotating-loadings.html"><a href="sec-dfa-rotating-loadings.html"><i class="fa fa-check"></i><b>10.8</b> Rotating trends and loadings</a></li>
<li class="chapter" data-level="10.9" data-path="sec-dfa-estimated-states.html"><a href="sec-dfa-estimated-states.html"><i class="fa fa-check"></i><b>10.9</b> Estimated states and loadings</a></li>
<li class="chapter" data-level="10.10" data-path="sec-dfa-plot-data.html"><a href="sec-dfa-plot-data.html"><i class="fa fa-check"></i><b>10.10</b> Plotting the data and model fits</a></li>
<li class="chapter" data-level="10.11" data-path="sec-dfa-covariates.html"><a href="sec-dfa-covariates.html"><i class="fa fa-check"></i><b>10.11</b> Covariates in DFA models</a></li>
<li class="chapter" data-level="10.12" data-path="sec-dfa-lakeWA.html"><a href="sec-dfa-lakeWA.html"><i class="fa fa-check"></i><b>10.12</b> Example from Lake Washington</a></li>
<li class="chapter" data-level="10.13" data-path="sec-dfa-problems.html"><a href="sec-dfa-problems.html"><i class="fa fa-check"></i><b>10.13</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap-mssmiss.html"><a href="chap-mssmiss.html"><i class="fa fa-check"></i><b>11</b> Covariates with Missing Values</a><ul>
<li class="chapter" data-level="" data-path="chap-mssmiss.html"><a href="chap-mssmiss.html#data-and-packages-7"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="11.1" data-path="sec-mssmiss-overview.html"><a href="sec-mssmiss-overview.html"><i class="fa fa-check"></i><b>11.1</b> Covariates with missing values or observation error</a></li>
<li class="chapter" data-level="11.2" data-path="example-snotel-data.html"><a href="example-snotel-data.html"><i class="fa fa-check"></i><b>11.2</b> Example: Snotel Data</a><ul>
<li class="chapter" data-level="11.2.1" data-path="example-snotel-data.html"><a href="example-snotel-data.html#estimate-missing-feb-swe-using-ar1-with-spatial-correlation"><i class="fa fa-check"></i><b>11.2.1</b> Estimate missing Feb SWE using AR(1) with spatial correlation</a></li>
<li class="chapter" data-level="11.2.2" data-path="example-snotel-data.html"><a href="example-snotel-data.html#estimate-missing-feb-swe-using-only-correlation"><i class="fa fa-check"></i><b>11.2.2</b> Estimate missing Feb SWE using only correlation</a></li>
<li class="chapter" data-level="11.2.3" data-path="example-snotel-data.html"><a href="example-snotel-data.html#estimate-missing-feb-swe-using-dfa"><i class="fa fa-check"></i><b>11.2.3</b> Estimate missing Feb SWE using DFA</a></li>
<li class="chapter" data-level="11.2.4" data-path="example-snotel-data.html"><a href="example-snotel-data.html#diagnostics-2"><i class="fa fa-check"></i><b>11.2.4</b> Diagnostics</a></li>
<li class="chapter" data-level="11.2.5" data-path="example-snotel-data.html"><a href="example-snotel-data.html#plot-the-fitted-or-mean-feb-swe-using-dfa"><i class="fa fa-check"></i><b>11.2.5</b> Plot the fitted or mean Feb SWE using DFA</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="modeling-seasonal-swe.html"><a href="modeling-seasonal-swe.html"><i class="fa fa-check"></i><b>11.3</b> Modeling Seasonal SWE</a><ul>
<li class="chapter" data-level="11.3.1" data-path="modeling-seasonal-swe.html"><a href="modeling-seasonal-swe.html#modeling-season-across-sites"><i class="fa fa-check"></i><b>11.3.1</b> Modeling season across sites</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chap-jags.html"><a href="chap-jags.html"><i class="fa fa-check"></i><b>12</b> JAGS for Bayesian time series analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="sec-jags-dataset.html"><a href="sec-jags-dataset.html"><i class="fa fa-check"></i><b>12.1</b> The airquality dataset</a></li>
<li class="chapter" data-level="12.2" data-path="sec-jags-lr-no-covariates.html"><a href="sec-jags-lr-no-covariates.html"><i class="fa fa-check"></i><b>12.2</b> Linear regression with no covariates</a></li>
<li class="chapter" data-level="12.3" data-path="sec-jags-regression-with-corr-errors.html"><a href="sec-jags-regression-with-corr-errors.html"><i class="fa fa-check"></i><b>12.3</b> Regression with autocorrelated errors</a></li>
<li class="chapter" data-level="12.4" data-path="sec-jags-rw.html"><a href="sec-jags-rw.html"><i class="fa fa-check"></i><b>12.4</b> Random walk time series model</a></li>
<li class="chapter" data-level="12.5" data-path="sec-jags-ar1.html"><a href="sec-jags-ar1.html"><i class="fa fa-check"></i><b>12.5</b> Autoregressive AR(1) time series models</a></li>
<li class="chapter" data-level="12.6" data-path="sec-jags-uss.html"><a href="sec-jags-uss.html"><i class="fa fa-check"></i><b>12.6</b> Univariate state space model</a><ul>
<li class="chapter" data-level="12.6.1" data-path="sec-jags-uss.html"><a href="sec-jags-uss.html#sec-jags-covariates"><i class="fa fa-check"></i><b>12.6.1</b> Including covariates</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="sec-jags-forecast.html"><a href="sec-jags-forecast.html"><i class="fa fa-check"></i><b>12.7</b> Forecasting with JAGS models</a></li>
<li class="chapter" data-level="12.8" data-path="sec-jags-problems.html"><a href="sec-jags-problems.html"><i class="fa fa-check"></i><b>12.8</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap-stan.html"><a href="chap-stan.html"><i class="fa fa-check"></i><b>13</b> Stan for Bayesian time series analysis</a><ul>
<li class="chapter" data-level="" data-path="chap-stan.html"><a href="chap-stan.html#data-and-packages-8"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="13.1" data-path="sec-stan-lr.html"><a href="sec-stan-lr.html"><i class="fa fa-check"></i><b>13.1</b> Linear regression</a><ul>
<li class="chapter" data-level="13.1.1" data-path="sec-stan-lr.html"><a href="sec-stan-lr.html#sec-stan-burn"><i class="fa fa-check"></i><b>13.1.1</b> Burn-in and thinning</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="sec-stan-lr-ar.html"><a href="sec-stan-lr-ar.html"><i class="fa fa-check"></i><b>13.2</b> Linear regression with correlated errors</a></li>
<li class="chapter" data-level="13.3" data-path="sec-stan-rw.html"><a href="sec-stan-rw.html"><i class="fa fa-check"></i><b>13.3</b> Random walk model</a></li>
<li class="chapter" data-level="13.4" data-path="sec-stan-ar1.html"><a href="sec-stan-ar1.html"><i class="fa fa-check"></i><b>13.4</b> Autoregressive models</a></li>
<li class="chapter" data-level="13.5" data-path="sec-stan-uss.html"><a href="sec-stan-uss.html"><i class="fa fa-check"></i><b>13.5</b> Univariate state-space models</a></li>
<li class="chapter" data-level="13.6" data-path="sec-stan-dfa.html"><a href="sec-stan-dfa.html"><i class="fa fa-check"></i><b>13.6</b> Dynamic factor analysis</a><ul>
<li class="chapter" data-level="13.6.1" data-path="sec-stan-dfa.html"><a href="sec-stan-dfa.html#sec-stan-loo"><i class="fa fa-check"></i><b>13.6.1</b> Using leave one out cross-validation to select models</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="sec-stan-state-uncertainty.html"><a href="sec-stan-state-uncertainty.html"><i class="fa fa-check"></i><b>13.7</b> Uncertainty intervals on states</a></li>
<li class="chapter" data-level="13.8" data-path="sec-stan-problems.html"><a href="sec-stan-problems.html"><i class="fa fa-check"></i><b>13.8</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="more-examples.html"><a href="more-examples.html"><i class="fa fa-check"></i>More examples</a></li>
<li class="chapter" data-level="14" data-path="chap-noisy-sensors-.html"><a href="chap-noisy-sensors-.html"><i class="fa fa-check"></i><b>14</b> Detecting a signal from noisy sensors</a><ul>
<li class="chapter" data-level="14.1" data-path="prep.html"><a href="prep.html"><i class="fa fa-check"></i><b>14.1</b> Prep</a></li>
<li class="chapter" data-level="14.2" data-path="create-a-signal.html"><a href="create-a-signal.html"><i class="fa fa-check"></i><b>14.2</b> Create a signal</a></li>
<li class="chapter" data-level="14.3" data-path="create-data.html"><a href="create-data.html"><i class="fa fa-check"></i><b>14.3</b> Create data</a></li>
<li class="chapter" data-level="14.4" data-path="model-shared-stochastic-level-with-ar-1-observation-errors.html"><a href="model-shared-stochastic-level-with-ar-1-observation-errors.html"><i class="fa fa-check"></i><b>14.4</b> Model Shared stochastic level with AR-1 observation errors</a></li>
<li class="chapter" data-level="14.5" data-path="fit-the-model.html"><a href="fit-the-model.html"><i class="fa fa-check"></i><b>14.5</b> Fit the model</a></li>
<li class="chapter" data-level="14.6" data-path="show-the-fits.html"><a href="show-the-fits.html"><i class="fa fa-check"></i><b>14.6</b> Show the fits</a></li>
<li class="chapter" data-level="14.7" data-path="estimated-common-trend-from-state-space-model.html"><a href="estimated-common-trend-from-state-space-model.html"><i class="fa fa-check"></i><b>14.7</b> Estimated common trend from state-space model</a></li>
<li class="chapter" data-level="14.8" data-path="compare-the-common-trend-to-mean-of-data.html"><a href="compare-the-common-trend-to-mean-of-data.html"><i class="fa fa-check"></i><b>14.8</b> Compare the common trend to mean of data</a></li>
<li class="chapter" data-level="14.9" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>14.9</b> Missing data</a></li>
<li class="chapter" data-level="14.10" data-path="correlated-noise.html"><a href="correlated-noise.html"><i class="fa fa-check"></i><b>14.10</b> Correlated noise</a></li>
<li class="chapter" data-level="14.11" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>14.11</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li style="font-weight: normal"><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Time Series Analysis for Fisheries and Environmental Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-dlm-forecasting-with-a-univariate-dlm" class="section level2">
<h2><span class="header-section-number">9.8</span> Forecasting</h2>
<p>Forecasting from a DLM involves two steps:</p>
<ol style="list-style-type: decimal">
<li><p>Get an estimate of the regression parameters at time <span class="math inline">\(t\)</span> from data up to time <span class="math inline">\(t-1\)</span>. These are also called the one-step ahead forecast (or prediction) of the regression parameters.</p></li>
<li><p>Make a prediction of <span class="math inline">\(y\)</span> at time <span class="math inline">\(t\)</span> based on the predictor variables at time <span class="math inline">\(t\)</span> and the estimate of the regression parameters at time <span class="math inline">\(t\)</span> (step 1). This is also called the one-step ahead forecast (or prediction) of the observation.</p></li>
</ol>
<div id="estimate-of-the-regression-parameters" class="section level3">
<h3><span class="header-section-number">9.8.1</span> Estimate of the regression parameters</h3>
<p>For step 1, we want to compute the distribution of the regression parameters at time <span class="math inline">\(t\)</span> conditioned on the data up to time <span class="math inline">\(t-1\)</span>, also known as the one-step ahead forecasts of the regression parameters. Let’s denote <span class="math inline">\(\boldsymbol{\theta}_{t-1}\)</span> conditioned on <span class="math inline">\(y_{1:t-1}\)</span> as <span class="math inline">\(\boldsymbol{\theta}_{t-1|t-1}\)</span> and denote <span class="math inline">\(\boldsymbol{\theta}_{t}\)</span> conditioned on <span class="math inline">\(y_{1:t-1}\)</span> as <span class="math inline">\(\boldsymbol{\theta}_{t|t-1}\)</span>. We will start by defining the distribution of <span class="math inline">\(\boldsymbol{\theta}_{t|t}\)</span> as follows
<span class="math display" id="eq:dlm-distthetatt">\[\begin{equation}
\tag{9.24}
\boldsymbol{\theta}_{t|t} \sim \text{MVN}(\boldsymbol{\pi}_t,\boldsymbol{\Lambda}_t) \end{equation}\]</span>
where <span class="math inline">\(\boldsymbol{\pi}_t = \text{E}(\boldsymbol{\theta}_{t|t})\)</span> and <span class="math inline">\(\mathbf{\Lambda}_t = \text{Var}(\boldsymbol{\theta}_{t|t})\)</span>.
Now we can compute the distribution of <span class="math inline">\(\boldsymbol{\theta}_{t}\)</span> conditioned on <span class="math inline">\(y_{1:t-1}\)</span> using the process equation for <span class="math inline">\(\boldsymbol{\theta}\)</span>:
<span class="math display">\[\begin{equation}
\boldsymbol{\theta}_{t} = \mathbf{G}_t \boldsymbol{\theta}_{t-1} + \mathbf{w}_t ~ \text{with} ~ \mathbf{w}_t \sim \text{MVN}(\mathbf{0}, \mathbf{Q}) \\
\end{equation}\]</span>
The expected value of <span class="math inline">\(\boldsymbol{\theta}_{t|t-1}\)</span> is thus
<span class="math display" id="eq:dlm-distthetatt-mean">\[\begin{equation}
\tag{9.25}
\text{E}(\boldsymbol{\theta}_{t|t-1}) = \mathbf{G}_t \text{E}(\boldsymbol{\theta}_{t-1|t-1}) = \mathbf{G}_t \boldsymbol{\pi}_{t-1}
\end{equation}\]</span>
The variance of <span class="math inline">\(\boldsymbol{\theta}_{t|t-1}\)</span> is
<span class="math display" id="eq:dlm-distthetatt-var">\[\begin{equation}
\tag{9.26}
\text{Var}(\boldsymbol{\theta}_{t|t-1}) = \mathbf{G}_t \text{Var}(\boldsymbol{\theta}_{t-1|t-1}) \mathbf{G}_t^{\top} + \mathbf{Q} = \mathbf{G}_t \mathbf{\Lambda}_{t-1} \mathbf{G}_t^{\top} + \mathbf{Q}
\end{equation}\]</span>
Thus the distribution of <span class="math inline">\(\boldsymbol{\theta}_{t}\)</span> conditioned on <span class="math inline">\(y_{1:t-1}\)</span> is
<span class="math display" id="eq:dlm-distthetatplus1-t">\[\begin{equation}
\tag{9.27}
\text{E}(\boldsymbol{\theta}_{t|t-1}) \sim \text{MVN}(\mathbf{G}_t \boldsymbol{\pi}_{t-1}, \mathbf{G}_t \mathbf{\Lambda}_{t-1} \mathbf{G}_t^{\top} + \mathbf{Q})
\end{equation}\]</span></p>
</div>
<div id="prediction-of-the-response-variable-y_t" class="section level3">
<h3><span class="header-section-number">9.8.2</span> Prediction of the response variable <span class="math inline">\(y_t\)</span></h3>
<p>For step 2, we make the prediction of <span class="math inline">\(y_{t}\)</span> given the predictor variables at time <span class="math inline">\(t\)</span> and the estimate of the regression parameters at time <span class="math inline">\(t\)</span>. This is called the one-step ahead prediction for the observation at time <span class="math inline">\(t\)</span>. We will denote the prediction of <span class="math inline">\(y\)</span> as <span class="math inline">\(\hat{y}\)</span> and we want to compute its distribution (mean and variance). We do this using the equation for <span class="math inline">\(y_t\)</span> but substituting the expected value of <span class="math inline">\(\boldsymbol{\theta}_{t|t-1}\)</span> for <span class="math inline">\(\boldsymbol{\theta}_t\)</span>.</p>
<p><span class="math display" id="eq:dlm-predict-y-tplus1">\[\begin{equation}
\tag{9.28}
\hat{y}_{t|t-1} = \mathbf{F}^{\top}_{t} \text{E}(\boldsymbol{\theta}_{t|t-1}) + e_{t} ~ \text{with} ~ e_{t} \sim \text{N}(0, r)  \\
\end{equation}\]</span>
Our prediction of <span class="math inline">\(y\)</span> at <span class="math inline">\(t\)</span> has a normal distribution with mean (expected value) and variance. The expected value of <span class="math inline">\(\hat{y}_{t|t-1}\)</span> is
<span class="math display" id="eq:dlm-predict-y-mean">\[\begin{equation}
\tag{9.29}
\text{E}(\hat{y}_{t|t-1}) = \mathbf{F}^{\top}_{t} \text{E}(\boldsymbol{\theta}_{t|t-1}) = \mathbf{F}^{\top}_{t} (\mathbf{G}_t \boldsymbol{\pi}_{t-1}) \\
\end{equation}\]</span>
and the variance of <span class="math inline">\(\hat{y}_{t|t-1}\)</span> is
<span class="math display" id="eq:dlm-predict-y-var">\[\begin{align}
\tag{9.30}
\text{Var}(\hat{y}_{t|t-1}) &amp;= \mathbf{F}^{\top}_{t} \text{Var}(\boldsymbol{\theta}_{t|t-1}) \mathbf{F}_{t} + r \\
 &amp;= \mathbf{F}^{\top}_{t} (\mathbf{G}_t \mathbf{\Lambda}_{t-1} \mathbf{G}_t^{\top} + \mathbf{Q}) \mathbf{F}_{t} + r \\
\end{align}\]</span></p>
</div>
<div id="computing-the-prediction" class="section level3">
<h3><span class="header-section-number">9.8.3</span> Computing the prediction</h3>
<p>The expectations and variance of <span class="math inline">\(\boldsymbol{\theta}_t\)</span> conditioned on <span class="math inline">\(y_{1:t}\)</span> and <span class="math inline">\(y_{1:t-1}\)</span> are standard output from the Kalman filter. Thus to produce the predictions, all we need to do is run our DLM state-space model through a Kalman filter to get <span class="math inline">\(\text{E}(\boldsymbol{\theta}_{t|t-1})\)</span> and <span class="math inline">\(\text{Var}(\boldsymbol{\theta}_{t|t-1})\)</span> and then use Equation <a href="sec-dlm-forecasting-with-a-univariate-dlm.html#eq:dlm-predict-y-mean">(9.29)</a> to compute the mean prediction and Equation <a href="sec-dlm-forecasting-with-a-univariate-dlm.html#eq:dlm-predict-y-var">(9.30)</a> to compute its variance.</p>
<p>The Kalman filter will need <span class="math inline">\(\mathbf{F}_t\)</span>, <span class="math inline">\(\mathbf{G}_t\)</span> and estimates of <span class="math inline">\(\mathbf{Q}\)</span> and <span class="math inline">\(r\)</span>. The latter are calculated by fitting the DLM to the data <span class="math inline">\(y_{1:t}\)</span>, using for example the <code>MARSS()</code> function.</p>
<p>Let’s see an example with the salmon survival DLM. We will use the Kalman filter function in the <strong>MARSS</strong> package and the DLM fit from <code>MARSS()</code>.</p>
</div>
<div id="forecasting-salmon-survival" class="section level3">
<h3><span class="header-section-number">9.8.4</span> Forecasting salmon survival</h3>
<p><span class="citation">Scheuerell and Williams (<a href="references.html#ref-ScheuerellWilliams2005" role="doc-biblioref">2005</a>)</span> were interested in how well upwelling could be used to actually <em>forecast</em> expected survival of salmon, so let’s look at how well our model does in that context. To do so, we need the predictive distribution for the survival at time <span class="math inline">\(t\)</span> given the upwelling at time <span class="math inline">\(t\)</span> and the predicted regression parameters at <span class="math inline">\(t\)</span>.</p>
<p>In the salmon survival DLM, the <span class="math inline">\(\mathbf{G}_t\)</span> matrix is the identity matrix, thus the mean and variance of the one-step ahead predictive distribution for the observation at time <span class="math inline">\(t\)</span> reduces to (from Equations <a href="sec-dlm-forecasting-with-a-univariate-dlm.html#eq:dlm-predict-y-mean">(9.29)</a> and <a href="sec-dlm-forecasting-with-a-univariate-dlm.html#eq:dlm-predict-y-var">(9.30)</a>)
<span class="math display" id="eq:dlm-dlmFore3">\[\begin{equation}
\tag{9.31}
\text{E}(\hat{y}_{t|t-1}) = \mathbf{F}^{\top}_{t} \text{E}(\boldsymbol{\theta}_{t|t-1}) \\ 
\text{Var}(\hat{y}_{t|t-1}) = \mathbf{F}^{\top}_{t} \text{Var}(\boldsymbol{\theta}_{t|t-1}) \mathbf{F}_{t} + \hat{r}
\end{equation}\]</span>
where
<span class="math display">\[
\mathbf{F}_{t}=\begin{bmatrix}1 \\ f_{t}\end{bmatrix}
\]</span>
and <span class="math inline">\(f_{t}\)</span> is the upwelling index at <span class="math inline">\(t+1\)</span>. <span class="math inline">\(\hat{r}\)</span> is the estimated observation variance from our model fit.</p>
</div>
<div id="sec-dlm-forecasting-a-univariate-dlm-with-marss" class="section level3">
<h3><span class="header-section-number">9.8.5</span> Forecasting using MARSS</h3>
<p>Working from Equation <a href="sec-dlm-forecasting-with-a-univariate-dlm.html#eq:dlm-dlmFore3">(9.31)</a>, we can compute the expected value of the forecast at time <span class="math inline">\(t\)</span> and its variance using the Kalman filter. For the expectation, we need <span class="math inline">\(\mathbf{F}_{t}^\top\text{E}(\boldsymbol{\theta}_{t|t-1})\)</span>.
<span class="math inline">\(\mathbf{F}_t^\top\)</span> is called <span class="math inline">\(\mathbf{Z}_t\)</span> in MARSS notation. The one-step ahead forecasts of the regression parameters at time <span class="math inline">\(t\)</span>, the <span class="math inline">\(\text{E}(\boldsymbol{\theta}_{t|t-1})\)</span>, are calculated as part of the Kalman filter algorithm—they are termed <span class="math inline">\(\tilde{x}_t^{t-1}\)</span> in MARSS notation and stored as <code>xtt1</code> in the list produced by the <code>MARSSkfss()</code> Kalman filter function.</p>
<p>Using the <code>Z</code> defined in <a href="sec-dlm-salmon-example.html#sec-dlm-salmon-example">9.6</a>, we compute the mean forecast as follows:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-1"></a><span class="co"># get list of Kalman filter output</span></span>
<span id="cb540-2"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-2"></a>kf.out &lt;-<span class="st"> </span><span class="kw">MARSSkfss</span>(dlm1)</span>
<span id="cb540-3"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-3"></a><span class="co">## forecasts of regr parameters; 2xT matrix</span></span>
<span id="cb540-4"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-4"></a>eta &lt;-<span class="st"> </span>kf.out<span class="op">$</span>xtt1</span>
<span id="cb540-5"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-5"></a><span class="co">## ts of E(forecasts)</span></span>
<span id="cb540-6"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-6"></a>fore.mean &lt;-<span class="st"> </span><span class="kw">vector</span>()</span>
<span id="cb540-7"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-7"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>TT) {</span>
<span id="cb540-8"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-8"></a>    fore.mean[t] &lt;-<span class="st"> </span>Z[, , t] <span class="op">%*%</span><span class="st"> </span>eta[, t, drop =<span class="st"> </span><span class="ot">FALSE</span>]</span>
<span id="cb540-9"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb540-9"></a>}</span></code></pre></div>
<p>For the variance of the forecasts, we need
<span class="math inline">\(\mathbf{F}^{\top}_{t} \text{Var}(\boldsymbol{\theta}_{t|t-1}) \mathbf{F}_{t} + \hat{r}\)</span>. As with the mean, <span class="math inline">\(\mathbf{F}^\top_t \equiv \mathbf{Z}_t\)</span>. The variances of the one-step ahead forecasts of the regression parameters at time <span class="math inline">\(t\)</span>, <span class="math inline">\(\text{Var}(\boldsymbol{\theta}_{t|t-1})\)</span>, are also calculated as part of the Kalman filter algorithm—they are stored as <code>Vtt1</code> in the list produced by the <code>MARSSkfss()</code> function. Lastly, the observation variance <span class="math inline">\(\hat{r}\)</span> was estimated when we fit the DLM to the data using <code>MARSS()</code> and can be extracted from the <code>dlm1</code> fit.</p>
<p>Putting this together, we can compute the forecast variance:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-1"></a><span class="co"># variance of regr parameters; 1x2xT array</span></span>
<span id="cb541-2"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-2"></a>Phi &lt;-<span class="st"> </span>kf.out<span class="op">$</span>Vtt1</span>
<span id="cb541-3"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-3"></a><span class="co">## obs variance; 1x1 matrix</span></span>
<span id="cb541-4"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-4"></a>R.est &lt;-<span class="st"> </span><span class="kw">coef</span>(dlm1, <span class="dt">type =</span> <span class="st">&quot;matrix&quot;</span>)<span class="op">$</span>R</span>
<span id="cb541-5"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-5"></a><span class="co">## ts of Var(forecasts)</span></span>
<span id="cb541-6"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-6"></a>fore.var &lt;-<span class="st"> </span><span class="kw">vector</span>()</span>
<span id="cb541-7"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-7"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>TT) {</span>
<span id="cb541-8"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-8"></a>    tZ &lt;-<span class="st"> </span><span class="kw">matrix</span>(Z[, , t], m, <span class="dv">1</span>)  <span class="co">## transpose of Z</span></span>
<span id="cb541-9"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-9"></a>    fore.var[t] &lt;-<span class="st"> </span>Z[, , t] <span class="op">%*%</span><span class="st"> </span>Phi[, , t] <span class="op">%*%</span><span class="st"> </span>tZ <span class="op">+</span><span class="st"> </span>R.est</span>
<span id="cb541-10"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#cb541-10"></a>}</span></code></pre></div>
<p>Plots of the model mean forecasts with their estimated uncertainty are shown in Figure <a href="sec-dlm-forecasting-with-a-univariate-dlm.html#fig:dlm-plotdlmForeLogit">9.3</a>. Nearly all of the observed values fell within the approximate prediction interval. Notice that we have a forecasted value for the first year of the time series (1964), which may seem at odds with our notion of forecasting at time <span class="math inline">\(t\)</span> based on data available only through time <span class="math inline">\(t-1\)</span>. In this case, however, MARSS is actually estimating the states at <span class="math inline">\(t=0\)</span> (<span class="math inline">\(\boldsymbol{\theta}_0\)</span>), which allows us to compute a forecast for the first time point.
<!-- % forecast plot - logit space --></p>

<div class="figure" style="text-align: center"><span id="fig:dlm-plotdlmForeLogit"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/dlm-plotdlmForeLogit-1.png" alt="Time series of logit-transformed survival data (blue dots) and model mean forecasts (thick line). Thin lines denote the approximate 95% prediction intervals." width="80%" />
<p class="caption">
Figure 9.3: Time series of logit-transformed survival data (blue dots) and model mean forecasts (thick line). Thin lines denote the approximate 95% prediction intervals.
</p>
</div>
<p>Although our model forecasts look reasonable in logit-space, it is worthwhile to examine how well they look when the survival data and forecasts are back-transformed onto the interval [0,1] (Figure <a href="sec-dlm-forecasting-with-a-univariate-dlm.html#fig:dlm-plotdlmForeRaw">9.4</a>). In that case, the accuracy does not seem to be affected, but the precision appears much worse, especially during the early and late portions of the time series when survival is changing rapidly.
<!-- % forecast plot - normal space --></p>

<div class="figure" style="text-align: center"><span id="fig:dlm-plotdlmForeRaw"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/dlm-plotdlmForeRaw-1.png" alt="Time series of survival data (blue dots) and model mean forecasts (thick line). Thin lines denote the approximate 95% prediction intervals." width="80%" />
<p class="caption">
Figure 9.4: Time series of survival data (blue dots) and model mean forecasts (thick line). Thin lines denote the approximate 95% prediction intervals.
</p>
</div>
<p>Notice that we passed the DLM fit to all the data to <code>MARSSkfss()</code>. This meant that the Kalman filter used estimates of <span class="math inline">\(\mathbf{Q}\)</span> and <span class="math inline">\(r\)</span> using all the data in the <code>xtt1</code> and <code>Vtt1</code> calculations. Thus our predictions at time <span class="math inline">\(t\)</span> are not entirely based on only data up to time <span class="math inline">\(t-1\)</span> since the <span class="math inline">\(\mathbf{Q}\)</span> and <span class="math inline">\(r\)</span> estimates were from all the data from 1964 to 2005.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-dlm-fitting-a-univariate-dlm-with-marss.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-dlm-dlm-forecast-diagnostics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nwfsc-timeseries/AFTSLabbook/blob/master/cleanedRmd/DLM.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applied_Time_Series_Analysis.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
