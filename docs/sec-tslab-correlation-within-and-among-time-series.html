<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 Correlation within and among time series | Applied Time Series Analysis for Fisheries and Environmental Sciences</title>
  <meta name="description" content="These are the computer labs for Fish 507: Applied Time Series Analysis for Fisheries and Environmental Sciences." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 Correlation within and among time series | Applied Time Series Analysis for Fisheries and Environmental Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="These are the computer labs for Fish 507: Applied Time Series Analysis for Fisheries and Environmental Sciences." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 Correlation within and among time series | Applied Time Series Analysis for Fisheries and Environmental Sciences" />
  
  <meta name="twitter:description" content="These are the computer labs for Fish 507: Applied Time Series Analysis for Fisheries and Environmental Sciences." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="E. E. Holmes, M. D. Scheuerell, and E. J. Ward" />


<meta name="date" content="2021-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html"/>
<link rel="next" href="sec-tslab-white-noise-wn.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Time Series Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-package"><i class="fa fa-check"></i>Book package</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors"><i class="fa fa-check"></i>Authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-basicmat.html"><a href="chap-basicmat.html"><i class="fa fa-check"></i><b>1</b> Basic matrix math in R</a><ul>
<li class="chapter" data-level="1.1" data-path="sec-basicmat-create.html"><a href="sec-basicmat-create.html"><i class="fa fa-check"></i><b>1.1</b> Creating matrices in R</a></li>
<li class="chapter" data-level="1.2" data-path="sec-basicmat-multiply.html"><a href="sec-basicmat-multiply.html"><i class="fa fa-check"></i><b>1.2</b> Matrix multiplication, addition and transpose</a></li>
<li class="chapter" data-level="1.3" data-path="sec-basicmat-subset.html"><a href="sec-basicmat-subset.html"><i class="fa fa-check"></i><b>1.3</b> Subsetting a matrix</a></li>
<li class="chapter" data-level="1.4" data-path="sec-basicmat-replace.html"><a href="sec-basicmat-replace.html"><i class="fa fa-check"></i><b>1.4</b> Replacing elements in a matrix</a></li>
<li class="chapter" data-level="1.5" data-path="sec-basicmat-diagonal.html"><a href="sec-basicmat-diagonal.html"><i class="fa fa-check"></i><b>1.5</b> Diagonal matrices and identity matrices</a></li>
<li class="chapter" data-level="1.6" data-path="sec-basicmat-inverse.html"><a href="sec-basicmat-inverse.html"><i class="fa fa-check"></i><b>1.6</b> Taking the inverse of a square matrix</a></li>
<li class="chapter" data-level="1.7" data-path="sec-basicmat-problems.html"><a href="sec-basicmat-problems.html"><i class="fa fa-check"></i><b>1.7</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-mlr.html"><a href="chap-mlr.html"><i class="fa fa-check"></i><b>2</b> Linear regression in matrix form</a><ul>
<li class="chapter" data-level="" data-path="chap-mlr.html"><a href="chap-mlr.html#data-and-packages"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="2.1" data-path="sec-mlr-lr1.html"><a href="sec-mlr-lr1.html"><i class="fa fa-check"></i><b>2.1</b> A simple regression: one explanatory variable</a></li>
<li class="chapter" data-level="2.2" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html"><i class="fa fa-check"></i><b>2.2</b> Matrix Form 1</a><ul>
<li class="chapter" data-level="2.2.1" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-solveform1"><i class="fa fa-check"></i><b>2.2.1</b> Solving for the parameters</a></li>
<li class="chapter" data-level="2.2.2" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-form1m"><i class="fa fa-check"></i><b>2.2.2</b> Form 1 with multiple explanatory variables</a></li>
<li class="chapter" data-level="2.2.3" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-form1when"><i class="fa fa-check"></i><b>2.2.3</b> When does Form 1 arise?</a></li>
<li class="chapter" data-level="2.2.4" data-path="sec-mlr-form1.html"><a href="sec-mlr-form1.html#sec-mlr-form1b"><i class="fa fa-check"></i><b>2.2.4</b> Matrix Form 1b: The transpose of Form 1</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sec-mlr-form2.html"><a href="sec-mlr-form2.html"><i class="fa fa-check"></i><b>2.3</b> Matrix Form 2</a><ul>
<li class="chapter" data-level="2.3.1" data-path="sec-mlr-form2.html"><a href="sec-mlr-form2.html#sec-mlr-form2m"><i class="fa fa-check"></i><b>2.3.1</b> Form 2 with multiple explanatory variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="sec-mlr-form2.html"><a href="sec-mlr-form2.html#sec-mlr-form2when"><i class="fa fa-check"></i><b>2.3.2</b> When does Form 2 arise?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sec-mlr-intercepts.html"><a href="sec-mlr-intercepts.html"><i class="fa fa-check"></i><b>2.4</b> Groups of intercepts</a><ul>
<li class="chapter" data-level="2.4.1" data-path="sec-mlr-intercepts.html"><a href="sec-mlr-intercepts.html#sec-mlr-intercepts-form1"><i class="fa fa-check"></i><b>2.4.1</b> North/South intercepts in Form 1</a></li>
<li class="chapter" data-level="2.4.2" data-path="sec-mlr-intercepts.html"><a href="sec-mlr-intercepts.html#sec-mlr-intercepts-form2"><i class="fa fa-check"></i><b>2.4.2</b> North/South intercepts in Form 2</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sec-mlr-betas.html"><a href="sec-mlr-betas.html"><i class="fa fa-check"></i><b>2.5</b> Groups of <span class="math inline">\(\beta\)</span>’s</a><ul>
<li class="chapter" data-level="2.5.1" data-path="sec-mlr-betas.html"><a href="sec-mlr-betas.html#sec-mlr-betas-form1"><i class="fa fa-check"></i><b>2.5.1</b> Owner <span class="math inline">\(\beta\)</span>’s in Form 1</a></li>
<li class="chapter" data-level="2.5.2" data-path="sec-mlr-betas.html"><a href="sec-mlr-betas.html#sec-mlr-betas-form2"><i class="fa fa-check"></i><b>2.5.2</b> Owner <span class="math inline">\(\beta\)</span>’s in Form 2</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sec-mlr-season-factor.html"><a href="sec-mlr-season-factor.html"><i class="fa fa-check"></i><b>2.6</b> Seasonal effect as a factor</a><ul>
<li class="chapter" data-level="2.6.1" data-path="sec-mlr-season-factor.html"><a href="sec-mlr-season-factor.html#sec-mlr-season-form1"><i class="fa fa-check"></i><b>2.6.1</b> Seasonal intercepts written in Form 1</a></li>
<li class="chapter" data-level="2.6.2" data-path="sec-mlr-season-factor.html"><a href="sec-mlr-season-factor.html#sec-mlr-season-form2"><i class="fa fa-check"></i><b>2.6.2</b> Seasonal intercepts written in Form 2</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sec-mlr-season-w-var.html"><a href="sec-mlr-season-w-var.html"><i class="fa fa-check"></i><b>2.7</b> Seasonal effect plus other explanatory variables*</a></li>
<li class="chapter" data-level="2.8" data-path="sec-mlr-confound.html"><a href="sec-mlr-confound.html"><i class="fa fa-check"></i><b>2.8</b> Models with confounded parameters*</a></li>
<li class="chapter" data-level="2.9" data-path="sec-mlr-solveform2.html"><a href="sec-mlr-solveform2.html"><i class="fa fa-check"></i><b>2.9</b> Solving for the parameters for Form 2*</a></li>
<li class="chapter" data-level="2.10" data-path="sec-mlr-problems.html"><a href="sec-mlr-problems.html"><i class="fa fa-check"></i><b>2.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-ts.html"><a href="chap-ts.html"><i class="fa fa-check"></i><b>3</b> Introduction to time series</a><ul>
<li class="chapter" data-level="3.1" data-path="sec-ts-examples.html"><a href="sec-ts-examples.html"><i class="fa fa-check"></i><b>3.1</b> Examples of time series</a></li>
<li class="chapter" data-level="3.2" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html"><i class="fa fa-check"></i><b>3.2</b> Classification of time series</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-some-index-set"><i class="fa fa-check"></i><b>3.2.1</b> By some <em>index set</em></a></li>
<li class="chapter" data-level="3.2.2" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-the-underlying-process"><i class="fa fa-check"></i><b>3.2.2</b> By the <em>underlying process</em></a></li>
<li class="chapter" data-level="3.2.3" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-the-number-of-values-recorded"><i class="fa fa-check"></i><b>3.2.3</b> By the <em>number of values recorded</em></a></li>
<li class="chapter" data-level="3.2.4" data-path="sec-ts-classification.html"><a href="sec-ts-classification.html#by-the-type-of-values-recorded"><i class="fa fa-check"></i><b>3.2.4</b> By the <em>type of values recorded</em></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sec-ts-stat-analysis.html"><a href="sec-ts-stat-analysis.html"><i class="fa fa-check"></i><b>3.3</b> Statistical analyses of time series</a></li>
<li class="chapter" data-level="3.4" data-path="sec-ts-definition.html"><a href="sec-ts-definition.html"><i class="fa fa-check"></i><b>3.4</b> What is a time series model?</a></li>
<li class="chapter" data-level="3.5" data-path="sec-ts-two-examples.html"><a href="sec-ts-two-examples.html"><i class="fa fa-check"></i><b>3.5</b> Two simple and classic time series models</a></li>
<li class="chapter" data-level="3.6" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html"><i class="fa fa-check"></i><b>3.6</b> Classical decomposition</a><ul>
<li class="chapter" data-level="3.6.1" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#the-trend-m_t"><i class="fa fa-check"></i><b>3.6.1</b> 1. The trend (<span class="math inline">\(m_t\)</span>)</a></li>
<li class="chapter" data-level="3.6.2" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#example-of-linear-filtering"><i class="fa fa-check"></i><b>3.6.2</b> Example of linear filtering</a></li>
<li class="chapter" data-level="3.6.3" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#seasonal-effect-s_t"><i class="fa fa-check"></i><b>3.6.3</b> 2. Seasonal effect (<span class="math inline">\(s_t\)</span>)</a></li>
<li class="chapter" data-level="3.6.4" data-path="sec-ts-classical-decomposition.html"><a href="sec-ts-classical-decomposition.html#remainder-e_t"><i class="fa fa-check"></i><b>3.6.4</b> 3. Remainder (<span class="math inline">\(e_t\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html"><i class="fa fa-check"></i><b>3.7</b> Decomposition on log-transformed data</a><ul>
<li class="chapter" data-level="3.7.1" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#the-trend-m_t-1"><i class="fa fa-check"></i><b>3.7.1</b> The trend (<span class="math inline">\(m_t\)</span>)</a></li>
<li class="chapter" data-level="3.7.2" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#seasonal-effect-s_t-with-error-e_t"><i class="fa fa-check"></i><b>3.7.2</b> Seasonal effect (<span class="math inline">\(s_t\)</span>) with error (<span class="math inline">\(e_t\)</span>)</a></li>
<li class="chapter" data-level="3.7.3" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#mean-seasonal-effect-s_t"><i class="fa fa-check"></i><b>3.7.3</b> Mean seasonal effect (<span class="math inline">\(s_t\)</span>)</a></li>
<li class="chapter" data-level="3.7.4" data-path="sec-ts-decomposition-log-data.html"><a href="sec-ts-decomposition-log-data.html#remainder-e_t-1"><i class="fa fa-check"></i><b>3.7.4</b> Remainder (<span class="math inline">\(e_t\)</span>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-tslab.html"><a href="chap-tslab.html"><i class="fa fa-check"></i><b>4</b> Basic time series functions in R</a><ul>
<li class="chapter" data-level="" data-path="chap-tslab.html"><a href="chap-tslab.html#data-and-packages-1"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="4.1" data-path="sec-tslab-time-series-plots.html"><a href="sec-tslab-time-series-plots.html"><i class="fa fa-check"></i><b>4.1</b> Time series plots</a><ul>
<li class="chapter" data-level="4.1.1" data-path="sec-tslab-time-series-plots.html"><a href="sec-tslab-time-series-plots.html#sec-tslab-textbfts-objects-and-verbplotts"><i class="fa fa-check"></i><b>4.1.1</b> <strong>ts</strong> objects and <code>plot.ts()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="sec-tslab-time-series-plots.html"><a href="sec-tslab-time-series-plots.html#sec-tslab-combining-and-plotting-multiple-textbfts-objects"><i class="fa fa-check"></i><b>4.1.2</b> Combining and plotting multiple <strong>ts</strong> objects</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html"><i class="fa fa-check"></i><b>4.2</b> Decomposition of time series</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-estimating-trends"><i class="fa fa-check"></i><b>4.2.1</b> Estimating trends</a></li>
<li class="chapter" data-level="4.2.2" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-estimating-seasonal-effects"><i class="fa fa-check"></i><b>4.2.2</b> Estimating seasonal effects</a></li>
<li class="chapter" data-level="4.2.3" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-completing-the-model"><i class="fa fa-check"></i><b>4.2.3</b> Completing the model</a></li>
<li class="chapter" data-level="4.2.4" data-path="sec-tslab-decomposition-of-time-series.html"><a href="sec-tslab-decomposition-of-time-series.html#sec-tslab-using-verbdecompose-for-decomposition"><i class="fa fa-check"></i><b>4.2.4</b> Using <code>decompose()</code> for decomposition</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html"><a href="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html"><i class="fa fa-check"></i><b>4.3</b> Differencing to remove a trend or seasonal effects</a><ul>
<li class="chapter" data-level="4.3.1" data-path="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html"><a href="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html#sec-tslab-using-the-verbdiff-function"><i class="fa fa-check"></i><b>4.3.1</b> Using the <code>diff()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html"><i class="fa fa-check"></i><b>4.4</b> Correlation within and among time series</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html#sec-tslab-autocorrelation-function-acf"><i class="fa fa-check"></i><b>4.4.1</b> Autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="4.4.2" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html#sec-tslab-partial-autocorrelation-function-pacf"><i class="fa fa-check"></i><b>4.4.2</b> Partial autocorrelation function (PACF)</a></li>
<li class="chapter" data-level="4.4.3" data-path="sec-tslab-correlation-within-and-among-time-series.html"><a href="sec-tslab-correlation-within-and-among-time-series.html#sec-tslab-cross-correlation-function-ccf"><i class="fa fa-check"></i><b>4.4.3</b> Cross-correlation function (CCF)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sec-tslab-white-noise-wn.html"><a href="sec-tslab-white-noise-wn.html"><i class="fa fa-check"></i><b>4.5</b> White noise (WN)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="sec-tslab-white-noise-wn.html"><a href="sec-tslab-white-noise-wn.html#sec-tslab-simulating-white-noise"><i class="fa fa-check"></i><b>4.5.1</b> Simulating white noise</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="sec-tslab-random-walks-rw.html"><a href="sec-tslab-random-walks-rw.html"><i class="fa fa-check"></i><b>4.6</b> Random walks (RW)</a><ul>
<li class="chapter" data-level="4.6.1" data-path="sec-tslab-random-walks-rw.html"><a href="sec-tslab-random-walks-rw.html#sec-tslab-simulating-a-random-walk"><i class="fa fa-check"></i><b>4.6.1</b> Simulating a random walk</a></li>
<li class="chapter" data-level="4.6.2" data-path="sec-tslab-random-walks-rw.html"><a href="sec-tslab-random-walks-rw.html#sec-tslab-alternative-formulation-of-a-random-walk"><i class="fa fa-check"></i><b>4.6.2</b> Alternative formulation of a random walk</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="sec-tslab-autoregressive-ar-models.html"><a href="sec-tslab-autoregressive-ar-models.html"><i class="fa fa-check"></i><b>4.7</b> Autoregressive (AR) models</a><ul>
<li class="chapter" data-level="4.7.1" data-path="sec-tslab-autoregressive-ar-models.html"><a href="sec-tslab-autoregressive-ar-models.html#sec-tslab-simulating-an-AR_p_coef-process"><i class="fa fa-check"></i><b>4.7.1</b> Simulating an AR(<span class="math inline">\(p\)</span>) process</a></li>
<li class="chapter" data-level="4.7.2" data-path="sec-tslab-autoregressive-ar-models.html"><a href="sec-tslab-autoregressive-ar-models.html#sec-tslab-correlation-structure-of-AR_p_coef-processes"><i class="fa fa-check"></i><b>4.7.2</b> Correlation structure of AR(<span class="math inline">\(p\)</span>) processes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="sec-tslab-moving-average-ma-models.html"><a href="sec-tslab-moving-average-ma-models.html"><i class="fa fa-check"></i><b>4.8</b> Moving-average (MA) models</a><ul>
<li class="chapter" data-level="4.8.1" data-path="sec-tslab-moving-average-ma-models.html"><a href="sec-tslab-moving-average-ma-models.html#sec-tslab-simulating-an-MA_q_coef-process"><i class="fa fa-check"></i><b>4.8.1</b> Simulating an MA(<span class="math inline">\(q\)</span>) process</a></li>
<li class="chapter" data-level="4.8.2" data-path="sec-tslab-moving-average-ma-models.html"><a href="sec-tslab-moving-average-ma-models.html#sec-tslab-correlation-structure-of-MA_q_coef-processes"><i class="fa fa-check"></i><b>4.8.2</b> Correlation structure of MA(<span class="math inline">\(q\)</span>) processes</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="sec-tslab-autoregressive-moving-average-arma-models.html"><a href="sec-tslab-autoregressive-moving-average-arma-models.html"><i class="fa fa-check"></i><b>4.9</b> Autoregressive moving-average (ARMA) models</a><ul>
<li class="chapter" data-level="4.9.1" data-path="sec-tslab-autoregressive-moving-average-arma-models.html"><a href="sec-tslab-autoregressive-moving-average-arma-models.html#sec-tslab-fitting-armapq-models-with-verbarima"><i class="fa fa-check"></i><b>4.9.1</b> Fitting ARMA(<span class="math inline">\(p,q\)</span>) models with <code>arima()</code></a></li>
<li class="chapter" data-level="4.9.2" data-path="sec-tslab-autoregressive-moving-average-arma-models.html"><a href="sec-tslab-autoregressive-moving-average-arma-models.html#sec-tslab-searching-over-model-orders"><i class="fa fa-check"></i><b>4.9.2</b> Searching over model orders</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="sec-tslab-problems.html"><a href="sec-tslab-problems.html"><i class="fa fa-check"></i><b>4.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-boxjenkins-.html"><a href="chap-boxjenkins-.html"><i class="fa fa-check"></i><b>5</b> Box-Jenkins method</a><ul>
<li class="chapter" data-level="" data-path="chap-boxjenkins-.html"><a href="chap-boxjenkins-.html#data-and-packages-2"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="5.1" data-path="sec-boxjenkins-intro.html"><a href="sec-boxjenkins-intro.html"><i class="fa fa-check"></i><b>5.1</b> Box-Jenkins method</a></li>
<li class="chapter" data-level="5.2" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html"><i class="fa fa-check"></i><b>5.2</b> Stationarity</a><ul>
<li class="chapter" data-level="5.2.1" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html#look-at-stationarity-in-simulated-data"><i class="fa fa-check"></i><b>5.2.1</b> Look at stationarity in simulated data</a></li>
<li class="chapter" data-level="5.2.2" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html#stationary-around-a-linear-trend"><i class="fa fa-check"></i><b>5.2.2</b> Stationary around a linear trend</a></li>
<li class="chapter" data-level="5.2.3" data-path="sec-boxjenkins-stationarity.html"><a href="sec-boxjenkins-stationarity.html#greek-landing-data"><i class="fa fa-check"></i><b>5.2.3</b> Greek landing data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html"><i class="fa fa-check"></i><b>5.3</b> Dickey-Fuller and Augmented Dickey-Fuller tests</a><ul>
<li class="chapter" data-level="5.3.1" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#dickey-fuller-test"><i class="fa fa-check"></i><b>5.3.1</b> Dickey-Fuller test</a></li>
<li class="chapter" data-level="5.3.2" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#augmented-dickey-fuller-test"><i class="fa fa-check"></i><b>5.3.2</b> Augmented Dickey-Fuller test</a></li>
<li class="chapter" data-level="5.3.3" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#adf-test-using-adf.test"><i class="fa fa-check"></i><b>5.3.3</b> ADF test using <code>adf.test()</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="sec-boxjenkins-aug-dickey-fuller.html"><a href="sec-boxjenkins-aug-dickey-fuller.html#adf-test-using-ur.df"><i class="fa fa-check"></i><b>5.3.4</b> ADF test using <code>ur.df()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sec-boxjenkins-kpss.html"><a href="sec-boxjenkins-kpss.html"><i class="fa fa-check"></i><b>5.4</b> KPSS test</a><ul>
<li class="chapter" data-level="5.4.1" data-path="sec-boxjenkins-kpss.html"><a href="sec-boxjenkins-kpss.html#test-on-simulated-data"><i class="fa fa-check"></i><b>5.4.1</b> Test on simulated data</a></li>
<li class="chapter" data-level="5.4.2" data-path="sec-boxjenkins-kpss.html"><a href="sec-boxjenkins-kpss.html#test-the-anchovy-data-1"><i class="fa fa-check"></i><b>5.4.2</b> Test the anchovy data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sec-boxjenkins-non-stationarity.html"><a href="sec-boxjenkins-non-stationarity.html"><i class="fa fa-check"></i><b>5.5</b> Dealing with non-stationarity</a><ul>
<li class="chapter" data-level="5.5.1" data-path="sec-boxjenkins-non-stationarity.html"><a href="sec-boxjenkins-non-stationarity.html#ndiffs"><i class="fa fa-check"></i><b>5.5.1</b> <code>ndiffs()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="sec-boxjenkins-stationarity-summary.html"><a href="sec-boxjenkins-stationarity-summary.html"><i class="fa fa-check"></i><b>5.6</b> Summary: stationarity testing</a></li>
<li class="chapter" data-level="5.7" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html"><i class="fa fa-check"></i><b>5.7</b> Estimating ARMA parameters</a><ul>
<li class="chapter" data-level="5.7.1" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#ar2-data"><i class="fa fa-check"></i><b>5.7.1</b> AR(2) data</a></li>
<li class="chapter" data-level="5.7.2" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#fit-with-arima"><i class="fa fa-check"></i><b>5.7.2</b> Fit with <code>Arima()</code></a></li>
<li class="chapter" data-level="5.7.3" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#ar1-simulated-data"><i class="fa fa-check"></i><b>5.7.3</b> AR(1) simulated data</a></li>
<li class="chapter" data-level="5.7.4" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#arma12-simulated-data"><i class="fa fa-check"></i><b>5.7.4</b> ARMA(1,2) simulated data</a></li>
<li class="chapter" data-level="5.7.5" data-path="sec-boxjenkins-est-ARMA-params.html"><a href="sec-boxjenkins-est-ARMA-params.html#these-functions-work-for-data-with-missing-values"><i class="fa fa-check"></i><b>5.7.5</b> These functions work for data with missing values</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html"><i class="fa fa-check"></i><b>5.8</b> Estimating the ARMA orders</a><ul>
<li class="chapter" data-level="5.8.1" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#example-model-selection-for-ar2-data"><i class="fa fa-check"></i><b>5.8.1</b> Example: model selection for AR(2) data</a></li>
<li class="chapter" data-level="5.8.2" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#fitting-to-100-simulated-data-sets"><i class="fa fa-check"></i><b>5.8.2</b> Fitting to 100 simulated data sets</a></li>
<li class="chapter" data-level="5.8.3" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#tracetrue"><i class="fa fa-check"></i><b>5.8.3</b> Trace=TRUE</a></li>
<li class="chapter" data-level="5.8.4" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#stepwisefalse"><i class="fa fa-check"></i><b>5.8.4</b> stepwise=FALSE</a></li>
<li class="chapter" data-level="5.8.5" data-path="sec-boxjenkins-est-ARMA-orders.html"><a href="sec-boxjenkins-est-ARMA-orders.html#fit-to-the-anchovy-data"><i class="fa fa-check"></i><b>5.8.5</b> Fit to the anchovy data</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="sec-boxjenkins-check-resids.html"><a href="sec-boxjenkins-check-resids.html"><i class="fa fa-check"></i><b>5.9</b> Check residuals</a></li>
<li class="chapter" data-level="5.10" data-path="sec-boxjenkins-forecast.html"><a href="sec-boxjenkins-forecast.html"><i class="fa fa-check"></i><b>5.10</b> Forecast from a fitted ARIMA model</a></li>
<li class="chapter" data-level="5.11" data-path="sec-boxjenkins-seasonal.html"><a href="sec-boxjenkins-seasonal.html"><i class="fa fa-check"></i><b>5.11</b> Seasonal ARIMA model</a><ul>
<li class="chapter" data-level="5.11.1" data-path="sec-boxjenkins-seasonal.html"><a href="sec-boxjenkins-seasonal.html#plot-seasonal-data"><i class="fa fa-check"></i><b>5.11.1</b> Plot seasonal data</a></li>
<li class="chapter" data-level="5.11.2" data-path="sec-boxjenkins-seasonal.html"><a href="sec-boxjenkins-seasonal.html#auto.arima-for-seasonal-ts"><i class="fa fa-check"></i><b>5.11.2</b> <code>auto.arima()</code> for seasonal ts</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="sec-boxjenkins-forecast-seasonal.html"><a href="sec-boxjenkins-forecast-seasonal.html"><i class="fa fa-check"></i><b>5.12</b> Forecast using a seasonal model</a></li>
<li class="chapter" data-level="5.13" data-path="sec-boxjenkins-problems.html"><a href="sec-boxjenkins-problems.html"><i class="fa fa-check"></i><b>5.13</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-univariate-state-space.html"><a href="chap-univariate-state-space.html"><i class="fa fa-check"></i><b>6</b> Univariate state-space models</a><ul>
<li class="chapter" data-level="" data-path="chap-univariate-state-space.html"><a href="chap-univariate-state-space.html#data-and-packages-3"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="6.1" data-path="sec-uss-fitting-a-state-space-model-with-marss.html"><a href="sec-uss-fitting-a-state-space-model-with-marss.html"><i class="fa fa-check"></i><b>6.1</b> Fitting a state-space model with MARSS</a></li>
<li class="chapter" data-level="6.2" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html"><i class="fa fa-check"></i><b>6.2</b> Examples using the Nile river data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-flat-level-model"><i class="fa fa-check"></i><b>6.2.1</b> Flat level model</a></li>
<li class="chapter" data-level="6.2.2" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-linear-trend-in-flow-model"><i class="fa fa-check"></i><b>6.2.2</b> Linear trend in flow model</a></li>
<li class="chapter" data-level="6.2.3" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-stochastic-level-model"><i class="fa fa-check"></i><b>6.2.3</b> Stochastic level model</a></li>
<li class="chapter" data-level="6.2.4" data-path="sec-uss-examples-using-the-nile-river-data.html"><a href="sec-uss-examples-using-the-nile-river-data.html#sec-uss-stochastic-level-model-with-drift"><i class="fa fa-check"></i><b>6.2.4</b> Stochastic level model with drift</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sec-uss-the-structts-function.html"><a href="sec-uss-the-structts-function.html"><i class="fa fa-check"></i><b>6.3</b> The StructTS function</a></li>
<li class="chapter" data-level="6.4" data-path="sec-uss-comparing-models-with-aic-and-model-weights.html"><a href="sec-uss-comparing-models-with-aic-and-model-weights.html"><i class="fa fa-check"></i><b>6.4</b> Comparing models with AIC and model weights</a></li>
<li class="chapter" data-level="6.5" data-path="sec-uss-basic-diagnostics.html"><a href="sec-uss-basic-diagnostics.html"><i class="fa fa-check"></i><b>6.5</b> Basic diagnostics</a><ul>
<li class="chapter" data-level="6.5.1" data-path="sec-uss-basic-diagnostics.html"><a href="sec-uss-basic-diagnostics.html#sec-uss-more-diagnostics"><i class="fa fa-check"></i><b>6.5.1</b> Outlier diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="sec-uss-fitting-with-jags.html"><a href="sec-uss-fitting-with-jags.html"><i class="fa fa-check"></i><b>6.6</b> Fitting with JAGS</a></li>
<li class="chapter" data-level="6.7" data-path="sec-uss-fitting-with-stan.html"><a href="sec-uss-fitting-with-stan.html"><i class="fa fa-check"></i><b>6.7</b> Fitting with Stan</a></li>
<li class="chapter" data-level="6.8" data-path="sec-uss-a-simple-random-walk-model-of-animal-movement.html"><a href="sec-uss-a-simple-random-walk-model-of-animal-movement.html"><i class="fa fa-check"></i><b>6.8</b> A random walk model of animal movement</a></li>
<li class="chapter" data-level="6.9" data-path="sec-uss-problems.html"><a href="sec-uss-problems.html"><i class="fa fa-check"></i><b>6.9</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap-mss.html"><a href="chap-mss.html"><i class="fa fa-check"></i><b>7</b> MARSS models</a><ul>
<li class="chapter" data-level="" data-path="chap-mss.html"><a href="chap-mss.html#data-and-packages-4"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="7.1" data-path="sec-mss-overview.html"><a href="sec-mss-overview.html"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="sec-mss-west-coast-harbor-seals-counts.html"><a href="sec-mss-west-coast-harbor-seals-counts.html"><i class="fa fa-check"></i><b>7.2</b> West coast harbor seals counts</a><ul>
<li class="chapter" data-level="7.2.1" data-path="sec-mss-west-coast-harbor-seals-counts.html"><a href="sec-mss-west-coast-harbor-seals-counts.html#sec-mss-load-the-harbor-seal-data"><i class="fa fa-check"></i><b>7.2.1</b> Load the harbor seal data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html"><i class="fa fa-check"></i><b>7.3</b> A single well-mixed population</a><ul>
<li class="chapter" data-level="7.3.1" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html#sec-mss-the-observation-process"><i class="fa fa-check"></i><b>7.3.1</b> The observation process</a></li>
<li class="chapter" data-level="7.3.2" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html#sec-mss-fitting-the-model"><i class="fa fa-check"></i><b>7.3.2</b> Fitting the model</a></li>
<li class="chapter" data-level="7.3.3" data-path="sec-mss-a-single-well-mixed-population.html"><a href="sec-mss-a-single-well-mixed-population.html#sec-mss-model-residuals"><i class="fa fa-check"></i><b>7.3.3</b> Model residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sec-mss-segind.html"><a href="sec-mss-segind.html"><i class="fa fa-check"></i><b>7.4</b> Four subpopulations with temporally uncorrelated errors</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sec-mss-segind.html"><a href="sec-mss-segind.html#sec-mss-the-observation-process-2"><i class="fa fa-check"></i><b>7.4.1</b> The observation process</a></li>
<li class="chapter" data-level="7.4.2" data-path="sec-mss-segind.html"><a href="sec-mss-segind.html#sec-mss-fitting-mod1"><i class="fa fa-check"></i><b>7.4.2</b> Fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><a href="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><i class="fa fa-check"></i><b>7.5</b> Four subpopulations with temporally correlated errors</a><ul>
<li class="chapter" data-level="7.5.1" data-path="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><a href="sec-mss-four-subpopulations-with-temporally-correlated-errors.html#sec-mss-fitting-mod2"><i class="fa fa-check"></i><b>7.5.1</b> Fitting the model</a></li>
<li class="chapter" data-level="7.5.2" data-path="sec-mss-four-subpopulations-with-temporally-correlated-errors.html"><a href="sec-mss-four-subpopulations-with-temporally-correlated-errors.html#sec-mss-residuals-mod2"><i class="fa fa-check"></i><b>7.5.2</b> Model residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sec-mss-using-marss-models-to-study-spatial-structure.html"><a href="sec-mss-using-marss-models-to-study-spatial-structure.html"><i class="fa fa-check"></i><b>7.6</b> Using MARSS models to study spatial structure</a></li>
<li class="chapter" data-level="7.7" data-path="sec-mss-hypotheses-regarding-spatial-structure.html"><a href="sec-mss-hypotheses-regarding-spatial-structure.html"><i class="fa fa-check"></i><b>7.7</b> Hypotheses regarding spatial structure</a></li>
<li class="chapter" data-level="7.8" data-path="sec-mss-set-up-the-hypotheses-as-different-models.html"><a href="sec-mss-set-up-the-hypotheses-as-different-models.html"><i class="fa fa-check"></i><b>7.8</b> Set up the hypotheses as different models</a><ul>
<li class="chapter" data-level="7.8.1" data-path="sec-mss-set-up-the-hypotheses-as-different-models.html"><a href="sec-mss-set-up-the-hypotheses-as-different-models.html#sec-fit-models-hyp"><i class="fa fa-check"></i><b>7.8.1</b> Fit the models</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html"><i class="fa fa-check"></i><b>7.9</b> Fitting a MARSS model with JAGS</a><ul>
<li class="chapter" data-level="7.9.1" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html#sec-mss-writing-the-model-in-jags"><i class="fa fa-check"></i><b>7.9.1</b> Writing the model in JAGS</a></li>
<li class="chapter" data-level="7.9.2" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html#fit-the-jags-model"><i class="fa fa-check"></i><b>7.9.2</b> Fit the JAGS model</a></li>
<li class="chapter" data-level="7.9.3" data-path="sec-mss-multivariate-state-space-models-with-jags.html"><a href="sec-mss-multivariate-state-space-models-with-jags.html#sec-mss-plot-the-posteriors-for-the-estimated-states"><i class="fa fa-check"></i><b>7.9.3</b> Plot the posteriors for the estimated states</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="sec-marss-fitting-with-stan.html"><a href="sec-marss-fitting-with-stan.html"><i class="fa fa-check"></i><b>7.10</b> Fitting a MARSS model with Stan</a></li>
<li class="chapter" data-level="7.11" data-path="sec-mss-problems.html"><a href="sec-mss-problems.html"><i class="fa fa-check"></i><b>7.11</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap-msscov.html"><a href="chap-msscov.html"><i class="fa fa-check"></i><b>8</b> MARSS models with covariates</a><ul>
<li class="chapter" data-level="" data-path="chap-msscov.html"><a href="chap-msscov.html#data-and-packages-5"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="8.1" data-path="sec-msscov-overview.html"><a href="sec-msscov-overview.html"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="sec-msscov-prepare-data.html"><a href="sec-msscov-prepare-data.html"><i class="fa fa-check"></i><b>8.2</b> Prepare the plankton data</a></li>
<li class="chapter" data-level="8.3" data-path="sec-msscov-obs-error-only.html"><a href="sec-msscov-obs-error-only.html"><i class="fa fa-check"></i><b>8.3</b> Observation-error only model</a></li>
<li class="chapter" data-level="8.4" data-path="sec-msscov-proc-error-only.html"><a href="sec-msscov-proc-error-only.html"><i class="fa fa-check"></i><b>8.4</b> Process-error only model</a></li>
<li class="chapter" data-level="8.5" data-path="sec-msscov-both-error.html"><a href="sec-msscov-both-error.html"><i class="fa fa-check"></i><b>8.5</b> Both process- and observation-error</a></li>
<li class="chapter" data-level="8.6" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html"><i class="fa fa-check"></i><b>8.6</b> Including seasonal effects in MARSS models</a><ul>
<li class="chapter" data-level="8.6.1" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html#sec-msscov-season-factors"><i class="fa fa-check"></i><b>8.6.1</b> Seasonal effects as fixed factors</a></li>
<li class="chapter" data-level="8.6.2" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html#sec-msscov-season-polynomial"><i class="fa fa-check"></i><b>8.6.2</b> Seasonal effects as a polynomial</a></li>
<li class="chapter" data-level="8.6.3" data-path="sec-msscov-season.html"><a href="sec-msscov-season.html#sec-msscov-season-fourier"><i class="fa fa-check"></i><b>8.6.3</b> Seasonal effects as a Fourier series</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="sec-msscov-model-diagnostics.html"><a href="sec-msscov-model-diagnostics.html"><i class="fa fa-check"></i><b>8.7</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.8" data-path="sec-msscov-hw-discussion.html"><a href="sec-msscov-hw-discussion.html"><i class="fa fa-check"></i><b>8.8</b> Homework data and discussion</a></li>
<li class="chapter" data-level="8.9" data-path="sec-msscov-problems.html"><a href="sec-msscov-problems.html"><i class="fa fa-check"></i><b>8.9</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap-dlm-dynamic-linear-models.html"><a href="chap-dlm-dynamic-linear-models.html"><i class="fa fa-check"></i><b>9</b> Dynamic linear models</a><ul>
<li class="chapter" data-level="" data-path="chap-dlm-dynamic-linear-models.html"><a href="chap-dlm-dynamic-linear-models.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="9.1" data-path="sec-dlm-overview.html"><a href="sec-dlm-overview.html"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="sec-dlm-state-space-form.html"><a href="sec-dlm-state-space-form.html"><i class="fa fa-check"></i><b>9.2</b> DLM in state-space form</a></li>
<li class="chapter" data-level="9.3" data-path="sec-dlm-simple-examples.html"><a href="sec-dlm-simple-examples.html"><i class="fa fa-check"></i><b>9.3</b> Stochastic level models</a><ul>
<li class="chapter" data-level="9.3.1" data-path="sec-dlm-simple-examples.html"><a href="sec-dlm-simple-examples.html#stochastic-level-with-drift"><i class="fa fa-check"></i><b>9.3.1</b> Stochastic level with drift</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sec-dlm-regression.html"><a href="sec-dlm-regression.html"><i class="fa fa-check"></i><b>9.4</b> Stochastic regression model</a></li>
<li class="chapter" data-level="9.5" data-path="sec-dlm-with-season.html"><a href="sec-dlm-with-season.html"><i class="fa fa-check"></i><b>9.5</b> DLM with seasonal effect</a></li>
<li class="chapter" data-level="9.6" data-path="sec-dlm-salmon-example.html"><a href="sec-dlm-salmon-example.html"><i class="fa fa-check"></i><b>9.6</b> Analysis of salmon survival</a></li>
<li class="chapter" data-level="9.7" data-path="sec-dlm-fitting-a-univariate-dlm-with-marss.html"><a href="sec-dlm-fitting-a-univariate-dlm-with-marss.html"><i class="fa fa-check"></i><b>9.7</b> Fitting with <code>MARSS()</code></a></li>
<li class="chapter" data-level="9.8" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a><ul>
<li class="chapter" data-level="9.8.1" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#estimate-of-the-regression-parameters"><i class="fa fa-check"></i><b>9.8.1</b> Estimate of the regression parameters</a></li>
<li class="chapter" data-level="9.8.2" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#prediction-of-the-response-variable-y_t"><i class="fa fa-check"></i><b>9.8.2</b> Prediction of the response variable <span class="math inline">\(y_t\)</span></a></li>
<li class="chapter" data-level="9.8.3" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#computing-the-prediction"><i class="fa fa-check"></i><b>9.8.3</b> Computing the prediction</a></li>
<li class="chapter" data-level="9.8.4" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#forecasting-salmon-survival"><i class="fa fa-check"></i><b>9.8.4</b> Forecasting salmon survival</a></li>
<li class="chapter" data-level="9.8.5" data-path="sec-dlm-forecasting-with-a-univariate-dlm.html"><a href="sec-dlm-forecasting-with-a-univariate-dlm.html#sec-dlm-forecasting-a-univariate-dlm-with-marss"><i class="fa fa-check"></i><b>9.8.5</b> Forecasting using MARSS</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="sec-dlm-dlm-forecast-diagnostics.html"><a href="sec-dlm-dlm-forecast-diagnostics.html"><i class="fa fa-check"></i><b>9.9</b> Forecast diagnostics</a></li>
<li class="chapter" data-level="9.10" data-path="sec-dlm-homework.html"><a href="sec-dlm-homework.html"><i class="fa fa-check"></i><b>9.10</b> Homework discussion and data</a><ul>
<li class="chapter" data-level="9.10.1" data-path="sec-dlm-homework.html"><a href="sec-dlm-homework.html#sec-dlm-spawner-recruit-data"><i class="fa fa-check"></i><b>9.10.1</b> Spawner-recruit data</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="sec-dlm-problems.html"><a href="sec-dlm-problems.html"><i class="fa fa-check"></i><b>9.11</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-dfa.html"><a href="sec-dfa.html"><i class="fa fa-check"></i><b>10</b> Dynamic Factor Analysis</a><ul>
<li class="chapter" data-level="" data-path="sec-dfa.html"><a href="sec-dfa.html#data-and-packages-6"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="10.1" data-path="sec-dfa-intro.html"><a href="sec-dfa-intro.html"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="sec-dfa-example1.html"><a href="sec-dfa-example1.html"><i class="fa fa-check"></i><b>10.2</b> Example of a DFA model</a></li>
<li class="chapter" data-level="10.3" data-path="sec-dfa-constraining-a-dfa-model.html"><a href="sec-dfa-constraining-a-dfa-model.html"><i class="fa fa-check"></i><b>10.3</b> Constraining a DFA model</a></li>
<li class="chapter" data-level="10.4" data-path="sec-dfa-different-error-structures.html"><a href="sec-dfa-different-error-structures.html"><i class="fa fa-check"></i><b>10.4</b> Different error structures</a></li>
<li class="chapter" data-level="10.5" data-path="sec-dfa-lake-wa-data.html"><a href="sec-dfa-lake-wa-data.html"><i class="fa fa-check"></i><b>10.5</b> Lake Washington phytoplankton data</a><ul>
<li class="chapter" data-level="10.5.1" data-path="sec-dfa-lake-wa-data.html"><a href="sec-dfa-lake-wa-data.html#sec-dfa-plot-lake-wa-data"><i class="fa fa-check"></i><b>10.5.1</b> Plots of the data</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html"><i class="fa fa-check"></i><b>10.6</b> Fitting DFA models with the MARSS package</a><ul>
<li class="chapter" data-level="10.6.1" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html#sec-dfa-observation-model"><i class="fa fa-check"></i><b>10.6.1</b> The observation model</a></li>
<li class="chapter" data-level="10.6.2" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html#sec-dfa-process-model"><i class="fa fa-check"></i><b>10.6.2</b> The process model</a></li>
<li class="chapter" data-level="10.6.3" data-path="sec-dfa-fitting-dfa-models-with-marss.html"><a href="sec-dfa-fitting-dfa-models-with-marss.html#sec-dfa-fit-model-in-marss"><i class="fa fa-check"></i><b>10.6.3</b> Fit the model in MARSS</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sec-dfa-interpreting-the-marss-output.html"><a href="sec-dfa-interpreting-the-marss-output.html"><i class="fa fa-check"></i><b>10.7</b> Interpreting the MARSS output</a></li>
<li class="chapter" data-level="10.8" data-path="sec-dfa-rotating-loadings.html"><a href="sec-dfa-rotating-loadings.html"><i class="fa fa-check"></i><b>10.8</b> Rotating trends and loadings</a></li>
<li class="chapter" data-level="10.9" data-path="sec-dfa-estimated-states.html"><a href="sec-dfa-estimated-states.html"><i class="fa fa-check"></i><b>10.9</b> Estimated states and loadings</a></li>
<li class="chapter" data-level="10.10" data-path="sec-dfa-plot-data.html"><a href="sec-dfa-plot-data.html"><i class="fa fa-check"></i><b>10.10</b> Plotting the data and model fits</a></li>
<li class="chapter" data-level="10.11" data-path="sec-dfa-covariates.html"><a href="sec-dfa-covariates.html"><i class="fa fa-check"></i><b>10.11</b> Covariates in DFA models</a></li>
<li class="chapter" data-level="10.12" data-path="sec-dfa-lakeWA.html"><a href="sec-dfa-lakeWA.html"><i class="fa fa-check"></i><b>10.12</b> Example from Lake Washington</a></li>
<li class="chapter" data-level="10.13" data-path="sec-dfa-problems.html"><a href="sec-dfa-problems.html"><i class="fa fa-check"></i><b>10.13</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap-mssmiss.html"><a href="chap-mssmiss.html"><i class="fa fa-check"></i><b>11</b> Covariates with Missing Values</a><ul>
<li class="chapter" data-level="" data-path="chap-mssmiss.html"><a href="chap-mssmiss.html#data-and-packages-7"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="11.1" data-path="sec-mssmiss-overview.html"><a href="sec-mssmiss-overview.html"><i class="fa fa-check"></i><b>11.1</b> Covariates with missing values or observation error</a></li>
<li class="chapter" data-level="11.2" data-path="example-snotel-data.html"><a href="example-snotel-data.html"><i class="fa fa-check"></i><b>11.2</b> Example: Snotel Data</a><ul>
<li class="chapter" data-level="11.2.1" data-path="example-snotel-data.html"><a href="example-snotel-data.html#estimate-missing-feb-swe-using-ar1-with-spatial-correlation"><i class="fa fa-check"></i><b>11.2.1</b> Estimate missing Feb SWE using AR(1) with spatial correlation</a></li>
<li class="chapter" data-level="11.2.2" data-path="example-snotel-data.html"><a href="example-snotel-data.html#estimate-missing-feb-swe-using-only-correlation"><i class="fa fa-check"></i><b>11.2.2</b> Estimate missing Feb SWE using only correlation</a></li>
<li class="chapter" data-level="11.2.3" data-path="example-snotel-data.html"><a href="example-snotel-data.html#estimate-missing-feb-swe-using-dfa"><i class="fa fa-check"></i><b>11.2.3</b> Estimate missing Feb SWE using DFA</a></li>
<li class="chapter" data-level="11.2.4" data-path="example-snotel-data.html"><a href="example-snotel-data.html#diagnostics-2"><i class="fa fa-check"></i><b>11.2.4</b> Diagnostics</a></li>
<li class="chapter" data-level="11.2.5" data-path="example-snotel-data.html"><a href="example-snotel-data.html#plot-the-fitted-or-mean-feb-swe-using-dfa"><i class="fa fa-check"></i><b>11.2.5</b> Plot the fitted or mean Feb SWE using DFA</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="modeling-seasonal-swe.html"><a href="modeling-seasonal-swe.html"><i class="fa fa-check"></i><b>11.3</b> Modeling Seasonal SWE</a><ul>
<li class="chapter" data-level="11.3.1" data-path="modeling-seasonal-swe.html"><a href="modeling-seasonal-swe.html#modeling-season-across-sites"><i class="fa fa-check"></i><b>11.3.1</b> Modeling season across sites</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chap-jags.html"><a href="chap-jags.html"><i class="fa fa-check"></i><b>12</b> JAGS for Bayesian time series analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="sec-jags-dataset.html"><a href="sec-jags-dataset.html"><i class="fa fa-check"></i><b>12.1</b> The airquality dataset</a></li>
<li class="chapter" data-level="12.2" data-path="sec-jags-lr-no-covariates.html"><a href="sec-jags-lr-no-covariates.html"><i class="fa fa-check"></i><b>12.2</b> Linear regression with no covariates</a></li>
<li class="chapter" data-level="12.3" data-path="sec-jags-regression-with-corr-errors.html"><a href="sec-jags-regression-with-corr-errors.html"><i class="fa fa-check"></i><b>12.3</b> Regression with autocorrelated errors</a></li>
<li class="chapter" data-level="12.4" data-path="sec-jags-rw.html"><a href="sec-jags-rw.html"><i class="fa fa-check"></i><b>12.4</b> Random walk time series model</a></li>
<li class="chapter" data-level="12.5" data-path="sec-jags-ar1.html"><a href="sec-jags-ar1.html"><i class="fa fa-check"></i><b>12.5</b> Autoregressive AR(1) time series models</a></li>
<li class="chapter" data-level="12.6" data-path="sec-jags-uss.html"><a href="sec-jags-uss.html"><i class="fa fa-check"></i><b>12.6</b> Univariate state space model</a><ul>
<li class="chapter" data-level="12.6.1" data-path="sec-jags-uss.html"><a href="sec-jags-uss.html#sec-jags-covariates"><i class="fa fa-check"></i><b>12.6.1</b> Including covariates</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="sec-jags-forecast.html"><a href="sec-jags-forecast.html"><i class="fa fa-check"></i><b>12.7</b> Forecasting with JAGS models</a></li>
<li class="chapter" data-level="12.8" data-path="sec-jags-problems.html"><a href="sec-jags-problems.html"><i class="fa fa-check"></i><b>12.8</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap-stan.html"><a href="chap-stan.html"><i class="fa fa-check"></i><b>13</b> Stan for Bayesian time series analysis</a><ul>
<li class="chapter" data-level="" data-path="chap-stan.html"><a href="chap-stan.html#data-and-packages-8"><i class="fa fa-check"></i>Data and packages</a></li>
<li class="chapter" data-level="13.1" data-path="sec-stan-lr.html"><a href="sec-stan-lr.html"><i class="fa fa-check"></i><b>13.1</b> Linear regression</a><ul>
<li class="chapter" data-level="13.1.1" data-path="sec-stan-lr.html"><a href="sec-stan-lr.html#sec-stan-burn"><i class="fa fa-check"></i><b>13.1.1</b> Burn-in and thinning</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="sec-stan-lr-ar.html"><a href="sec-stan-lr-ar.html"><i class="fa fa-check"></i><b>13.2</b> Linear regression with correlated errors</a></li>
<li class="chapter" data-level="13.3" data-path="sec-stan-rw.html"><a href="sec-stan-rw.html"><i class="fa fa-check"></i><b>13.3</b> Random walk model</a></li>
<li class="chapter" data-level="13.4" data-path="sec-stan-ar1.html"><a href="sec-stan-ar1.html"><i class="fa fa-check"></i><b>13.4</b> Autoregressive models</a></li>
<li class="chapter" data-level="13.5" data-path="sec-stan-uss.html"><a href="sec-stan-uss.html"><i class="fa fa-check"></i><b>13.5</b> Univariate state-space models</a></li>
<li class="chapter" data-level="13.6" data-path="sec-stan-dfa.html"><a href="sec-stan-dfa.html"><i class="fa fa-check"></i><b>13.6</b> Dynamic factor analysis</a><ul>
<li class="chapter" data-level="13.6.1" data-path="sec-stan-dfa.html"><a href="sec-stan-dfa.html#sec-stan-loo"><i class="fa fa-check"></i><b>13.6.1</b> Using leave one out cross-validation to select models</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="sec-stan-state-uncertainty.html"><a href="sec-stan-state-uncertainty.html"><i class="fa fa-check"></i><b>13.7</b> Uncertainty intervals on states</a></li>
<li class="chapter" data-level="13.8" data-path="sec-stan-problems.html"><a href="sec-stan-problems.html"><i class="fa fa-check"></i><b>13.8</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="more-examples.html"><a href="more-examples.html"><i class="fa fa-check"></i>More examples</a></li>
<li class="chapter" data-level="14" data-path="chap-noisy-sensors-.html"><a href="chap-noisy-sensors-.html"><i class="fa fa-check"></i><b>14</b> Detecting a signal from noisy sensors</a><ul>
<li class="chapter" data-level="14.1" data-path="prep.html"><a href="prep.html"><i class="fa fa-check"></i><b>14.1</b> Prep</a></li>
<li class="chapter" data-level="14.2" data-path="create-a-signal.html"><a href="create-a-signal.html"><i class="fa fa-check"></i><b>14.2</b> Create a signal</a></li>
<li class="chapter" data-level="14.3" data-path="create-data.html"><a href="create-data.html"><i class="fa fa-check"></i><b>14.3</b> Create data</a></li>
<li class="chapter" data-level="14.4" data-path="model-shared-stochastic-level-with-ar-1-observation-errors.html"><a href="model-shared-stochastic-level-with-ar-1-observation-errors.html"><i class="fa fa-check"></i><b>14.4</b> Model Shared stochastic level with AR-1 observation errors</a></li>
<li class="chapter" data-level="14.5" data-path="fit-the-model.html"><a href="fit-the-model.html"><i class="fa fa-check"></i><b>14.5</b> Fit the model</a></li>
<li class="chapter" data-level="14.6" data-path="show-the-fits.html"><a href="show-the-fits.html"><i class="fa fa-check"></i><b>14.6</b> Show the fits</a></li>
<li class="chapter" data-level="14.7" data-path="estimated-common-trend-from-state-space-model.html"><a href="estimated-common-trend-from-state-space-model.html"><i class="fa fa-check"></i><b>14.7</b> Estimated common trend from state-space model</a></li>
<li class="chapter" data-level="14.8" data-path="compare-the-common-trend-to-mean-of-data.html"><a href="compare-the-common-trend-to-mean-of-data.html"><i class="fa fa-check"></i><b>14.8</b> Compare the common trend to mean of data</a></li>
<li class="chapter" data-level="14.9" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>14.9</b> Missing data</a></li>
<li class="chapter" data-level="14.10" data-path="correlated-noise.html"><a href="correlated-noise.html"><i class="fa fa-check"></i><b>14.10</b> Correlated noise</a></li>
<li class="chapter" data-level="14.11" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>14.11</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li style="font-weight: normal"><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Time Series Analysis for Fisheries and Environmental Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-tslab-correlation-within-and-among-time-series" class="section level2">
<h2><span class="header-section-number">4.4</span> Correlation within and among time series</h2>
<p>The concepts of covariance and correlation are very important in time series analysis. In particular, we can examine the correlation structure of the original data or random errors from a decomposition model to help us identify possible form(s) of (non)stationary model(s) for the stochastic process.</p>
<div id="sec-tslab-autocorrelation-function-acf" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Autocorrelation function (ACF)</h3>
<p>Autocorrelation is the correlation of a variable with itself at differing time lags. Recall from lecture that we defined the sample autocovariance function (ACVF), <span class="math inline">\(c_k\)</span>, for some lag <span class="math inline">\(k\)</span> as</p>
<p><span class="math display" id="eq:ACVF">\[\begin{equation}
\tag{4.10}
c_k = \frac{1}{n}\sum_{t=1}^{n-k} \left(x_t-\bar{x}\right) \left(x_{t+k}-\bar{x}\right)
\end{equation}\]</span></p>
<p>Note that the sample autocovariance of <span class="math inline">\(\{x_t\}\)</span> at lag 0, <span class="math inline">\(c_0\)</span>, equals the sample variance of <span class="math inline">\(\{x_t\}\)</span> calculated with a denominator of <span class="math inline">\(n\)</span>. The sample autocorrelation function (ACF) is defined as</p>
<p><span class="math display" id="eq:ACF">\[\begin{equation}
\tag{4.11}
r_k = \frac{c_k}{c_0} = \text{Cor}(x_t,x_{t+k})
\end{equation}\]</span></p>
<p>Recall also that an approximate 95% confidence interval on the ACF can be estimated by</p>
<p><span class="math display" id="eq:ACF95CI">\[\begin{equation}
\tag{4.12}
-\frac{1}{n} \pm \frac{2}{\sqrt{n}}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of data points used in the calculation of the ACF.</p>
<p>It is important to remember two things here. First, although the confidence interval is commonly plotted and interpreted as a horizontal line over all time lags, the interval itself actually grows as the lag increases because the number of data points <span class="math inline">\(n\)</span> used to estimate the correlation decreases by 1 for every integer increase in lag. Second, care must be exercised when interpreting the “significance” of the correlation at various lags because we should expect, <em>a priori</em>, that approximately 1 out of every 20 correlations will be significant based on chance alone.</p>
<p>We can use the <code>acf()</code> function in R to compute the sample ACF (note that adding the option <code>type = "covariance"</code> will return the sample auto-covariance (ACVF) instead of the ACF–type <code>?acf</code> for details). Calling the function by itself will will automatically produce a correlogram (<em>i.e.</em>, a plot of the autocorrelation versus time lag). The argument <code>lag.max</code> allows you to set the number of positive and negative lags. Let’s try it for the CO<span class="math inline">\(_2\)</span> data.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb228-1"></a><span class="co">## correlogram of the CO2 data</span></span>
<span id="cb228-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb228-2"></a><span class="kw">acf</span>(co2, <span class="dt">lag.max =</span> <span class="dv">36</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotACFb"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotACFb-1.png" alt="Correlogram of the observed atmospheric CO\(_2\) concentration at Mauna Loa, Hawai’i obtained with the function acf()." width="80%" />
<p class="caption">
Figure 4.10: Correlogram of the observed atmospheric CO<span class="math inline">\(_2\)</span> concentration at Mauna Loa, Hawai’i obtained with the function <code>acf()</code>.
</p>
</div>
<p>There are 4 things about Figure <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotACFb">4.10</a> that are noteworthy:</p>
<ol style="list-style-type: decimal">
<li>the ACF at lag 0, <span class="math inline">\(r_0\)</span>, equals 1 by default (<em>i.e.</em>, the correlation of a time series with itself)–it’s plotted as a reference point;</li>
<li>the <span class="math inline">\(x\)</span>-axis has decimal values for lags, which is caused by R using the year index as the lag rather than the month;</li>
<li>the horizontal blue lines are the approximate 95% CI’s; and</li>
<li>there is very high autocorrelation even out to lags of 36 months.</li>
</ol>
<p>As an alternative to the default plots for <strong>acf</strong> objects, let’s define a new plot function for <strong>acf</strong> objects with some better features:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-1"></a><span class="co">## better ACF plot</span></span>
<span id="cb229-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-2"></a>plot.acf &lt;-<span class="st"> </span><span class="cf">function</span>(ACFobj) {</span>
<span id="cb229-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-3"></a>    rr &lt;-<span class="st"> </span>ACFobj<span class="op">$</span>acf[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb229-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-4"></a>    kk &lt;-<span class="st"> </span><span class="kw">length</span>(rr)</span>
<span id="cb229-5"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-5"></a>    nn &lt;-<span class="st"> </span>ACFobj<span class="op">$</span>n.used</span>
<span id="cb229-6"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-6"></a>    <span class="kw">plot</span>(<span class="kw">seq</span>(kk), rr, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, </span>
<span id="cb229-7"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-7"></a>        <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">floor</span>(<span class="kw">min</span>(rr)), <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, kk <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">xlab =</span> <span class="st">&quot;Lag&quot;</span>, </span>
<span id="cb229-8"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-8"></a>        <span class="dt">ylab =</span> <span class="st">&quot;Correlation&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)</span>
<span id="cb229-9"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-9"></a>    <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">-1</span><span class="op">/</span>nn <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(nn), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb229-10"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-10"></a>    <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</span>
<span id="cb229-11"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb229-11"></a>}</span></code></pre></div>
<p>Now we can assign the result of <code>acf()</code> to a variable and then use the information contained therein to plot the correlogram with our new plot function.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb230-1"></a><span class="co">## acf of the CO2 data</span></span>
<span id="cb230-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb230-2"></a>co2_acf &lt;-<span class="st"> </span><span class="kw">acf</span>(co2, <span class="dt">lag.max =</span> <span class="dv">36</span>)</span>
<span id="cb230-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb230-3"></a><span class="co">## correlogram of the CO2 data</span></span>
<span id="cb230-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb230-4"></a><span class="kw">plot.acf</span>(co2_acf)</span></code></pre></div>
<p><img src="Applied_Time_Series_Analysis_files/figure-html/tslab-DoOurACF-1.png" width="80%" style="display: block; margin: auto;" /></p>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotbetterACF"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotbetterACF-1.png" alt="Correlogram of the observed atmospheric CO\(_2\) concentration at Mauna Loa, Hawai’i obtained with the function plot.acf()." width="80%" />
<p class="caption">
Figure 4.11: Correlogram of the observed atmospheric CO<span class="math inline">\(_2\)</span> concentration at Mauna Loa, Hawai’i obtained with the function <code>plot.acf()</code>.
</p>
</div>
<p>Notice that all of the relevant information is still there (Figure <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotbetterACF">4.11</a>), but now <span class="math inline">\(r_0=1\)</span> is not plotted at lag-0 and the lags on the <span class="math inline">\(x\)</span>-axis are displayed correctly as integers.</p>
<p>Before we move on to the PACF, let’s look at the ACF for some deterministic time series, which will help you identify interesting properties (<em>e.g.</em>, trends, seasonal effects) in a stochastic time series, and account for them in time series models–an important topic in this course. First, let’s look at a straight line.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-1"></a><span class="co">## length of ts</span></span>
<span id="cb231-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-2"></a>nn &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb231-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-3"></a><span class="co">## create straight line</span></span>
<span id="cb231-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-4"></a>tt &lt;-<span class="st"> </span><span class="kw">seq</span>(nn)</span>
<span id="cb231-5"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-5"></a><span class="co">## set up plot area</span></span>
<span id="cb231-6"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-6"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb231-7"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-7"></a><span class="co">## plot line</span></span>
<span id="cb231-8"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-8"></a><span class="kw">plot.ts</span>(tt, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">italic</span>(x[t])))</span>
<span id="cb231-9"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-9"></a><span class="co">## get ACF</span></span>
<span id="cb231-10"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-10"></a>line.acf &lt;-<span class="st"> </span><span class="kw">acf</span>(tt, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb231-11"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-11"></a><span class="co">## plot ACF</span></span>
<span id="cb231-12"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb231-12"></a><span class="kw">plot.acf</span>(line.acf)</span></code></pre></div>
<p><img src="Applied_Time_Series_Analysis_files/figure-html/tslab-LinearACF-1.png" width="80%" style="display: block; margin: auto;" /></p>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotLinearACF"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotLinearACF-1.png" alt="Time series plot of a straight line (left) and the correlogram of its ACF (right)." width="80%" />
<p class="caption">
Figure 4.12: Time series plot of a straight line (left) and the correlogram of its ACF (right).
</p>
</div>
<p>The correlogram for a straight line is itself a linearly decreasing function over time (Figure <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotLinearACF">4.12</a>).</p>
<p>Now let’s examine the ACF for a sine wave and see what sort of pattern arises.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-1"></a><span class="co">## create sine wave</span></span>
<span id="cb232-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-2"></a>tt &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span><span class="kw">seq</span>(nn)<span class="op">/</span><span class="dv">12</span>)</span>
<span id="cb232-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-3"></a><span class="co">## set up plot area</span></span>
<span id="cb232-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-4"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb232-5"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-5"></a><span class="co">## plot line</span></span>
<span id="cb232-6"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-6"></a><span class="kw">plot.ts</span>(tt, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">italic</span>(x[t])))</span>
<span id="cb232-7"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-7"></a><span class="co">## get ACF</span></span>
<span id="cb232-8"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-8"></a>sine_acf &lt;-<span class="st"> </span><span class="kw">acf</span>(tt, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb232-9"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-9"></a><span class="co">## plot ACF</span></span>
<span id="cb232-10"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb232-10"></a><span class="kw">plot.acf</span>(sine_acf)</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotSineACF"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotSineACF-1.png" alt="Time series plot of a discrete sine wave (left) and the correlogram of its ACF (right)." width="80%" />
<p class="caption">
Figure 4.13: Time series plot of a discrete sine wave (left) and the correlogram of its ACF (right).
</p>
</div>
<p>Perhaps not surprisingly, the correlogram for a sine wave is itself a sine wave whose amplitude decreases linearly over time (Figure <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotSineACF">4.13</a>).</p>
<p>Now let’s examine the ACF for a sine wave with a linear downward trend and see what sort of patterns arise.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-1"></a><span class="co">## create sine wave with trend</span></span>
<span id="cb233-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-2"></a>tt &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span><span class="kw">seq</span>(nn)<span class="op">/</span><span class="dv">12</span>) <span class="op">-</span><span class="st"> </span><span class="kw">seq</span>(nn)<span class="op">/</span><span class="dv">50</span></span>
<span id="cb233-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-3"></a><span class="co">## set up plot area</span></span>
<span id="cb233-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-4"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb233-5"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-5"></a><span class="co">## plot line</span></span>
<span id="cb233-6"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-6"></a><span class="kw">plot.ts</span>(tt, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">italic</span>(x[t])))</span>
<span id="cb233-7"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-7"></a><span class="co">## get ACF</span></span>
<span id="cb233-8"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-8"></a>sili_acf &lt;-<span class="st"> </span><span class="kw">acf</span>(tt, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb233-9"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-9"></a><span class="co">## plot ACF</span></span>
<span id="cb233-10"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb233-10"></a><span class="kw">plot.acf</span>(sili_acf)</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotSiLiACF"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotSiLiACF-1.png" alt="Time series plot of a discrete sine wave (left) and the correlogram of its ACF (right)." width="80%" />
<p class="caption">
Figure 4.14: Time series plot of a discrete sine wave (left) and the correlogram of its ACF (right).
</p>
</div>
<p>The correlogram for a sine wave with a trend is itself a nonsymmetrical sine wave whose amplitude and center decrease over time (Figure <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotSiLiACF">4.14</a>).</p>
<p>As we have seen, the ACF is a powerful tool in time series analysis for identifying important features in the data. As we will see later, the ACF is also an important diagnostic tool for helping to select the proper order of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> in ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models.</p>
</div>
<div id="sec-tslab-partial-autocorrelation-function-pacf" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Partial autocorrelation function (PACF)</h3>
<p>The partial autocorrelation function (PACF) measures the linear correlation of a series <span class="math inline">\(\{x_t\}\)</span> and a lagged version of itself <span class="math inline">\(\{x_{t+k}\}\)</span> with the linear dependence of <span class="math inline">\(\{x_{t-1},x_{t-2},\dots,x_{t-(k-1)}\}\)</span> removed. Recall from lecture that we define the PACF as</p>
<p><span class="math display" id="eq:PACFdefn">\[\begin{equation}
\tag{4.13}
f_k = \begin{cases}
        \text{Cor}(x_1,x_0)=r_1 &amp; \text{if } k = 1;\\
        \text{Cor}(x_k-x_k^{k-1},x_0-x_0^{k-1}) &amp; \text{if } k \geq 2;
      \end{cases}
\end{equation}\]</span></p>
<p>with</p>

<p>It’s easy to compute the PACF for a variable in R using the <code>pacf()</code> function, which will automatically plot a correlogram when called by itself (similar to <code>acf()</code>). Let’s look at the PACF for the CO<span class="math inline">\(_2\)</span> data.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb234-1"></a><span class="co">## PACF of the CO2 data</span></span>
<span id="cb234-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb234-2"></a><span class="kw">pacf</span>(co2, <span class="dt">lag.max =</span> <span class="dv">36</span>)</span></code></pre></div>
<p>The default plot for PACF is a bit better than for ACF, but here is another plotting function that might be useful.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-1"></a><span class="co">## better PACF plot</span></span>
<span id="cb235-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-2"></a>plot.pacf &lt;-<span class="st"> </span><span class="cf">function</span>(PACFobj) {</span>
<span id="cb235-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-3"></a>    rr &lt;-<span class="st"> </span>PACFobj<span class="op">$</span>acf</span>
<span id="cb235-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-4"></a>    kk &lt;-<span class="st"> </span><span class="kw">length</span>(rr)</span>
<span id="cb235-5"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-5"></a>    nn &lt;-<span class="st"> </span>PACFobj<span class="op">$</span>n.used</span>
<span id="cb235-6"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-6"></a>    <span class="kw">plot</span>(<span class="kw">seq</span>(kk), rr, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, </span>
<span id="cb235-7"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-7"></a>        <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">floor</span>(<span class="kw">min</span>(rr)), <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, kk <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">xlab =</span> <span class="st">&quot;Lag&quot;</span>, </span>
<span id="cb235-8"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-8"></a>        <span class="dt">ylab =</span> <span class="st">&quot;PACF&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)</span>
<span id="cb235-9"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-9"></a>    <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">-1</span><span class="op">/</span>nn <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(nn), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb235-10"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-10"></a>    <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</span>
<span id="cb235-11"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb235-11"></a>}</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotPACFb"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotPACFb-1.png" alt="Correlogram of the PACF for the observed atmospheric CO\(_2\) concentration at Mauna Loa, Hawai’i obtained with the function pacf()." width="80%" />
<p class="caption">
Figure 4.15: Correlogram of the PACF for the observed atmospheric CO<span class="math inline">\(_2\)</span> concentration at Mauna Loa, Hawai’i obtained with the function <code>pacf()</code>.
</p>
</div>
<p>Notice in Figure <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotPACFb">4.15</a> that the partial autocorrelation at lag-1 is very high (it equals the ACF at lag-1), but the other values at lags &gt; 1 are relatively small, unlike what we saw for the ACF. We will discuss this in more detail later on in this lab.</p>
<p>Notice also that the PACF plot again has real-valued indices for the time lag, but it does not include any value for lag-0 because it is impossible to remove any intermediate autocorrelation between <span class="math inline">\(t\)</span> and <span class="math inline">\(t-k\)</span> when <span class="math inline">\(k=0\)</span>, and therefore the PACF does not exist at lag-0. If you would like, you can use the <code>plot.acf()</code> function we defined above to plot the PACF estimates because <code>acf()</code> and <code>pacf()</code> produce identical list structures (results not shown here).</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb236-1"></a><span class="co">## PACF of the CO2 data</span></span>
<span id="cb236-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb236-2"></a>co2_pacf &lt;-<span class="st"> </span><span class="kw">pacf</span>(co2)</span>
<span id="cb236-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb236-3"></a><span class="co">## correlogram of the CO2 data</span></span>
<span id="cb236-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb236-4"></a><span class="kw">plot.acf</span>(co2_pacf)</span></code></pre></div>
<p>As with the ACF, we will see later on how the PACF can also be used to help identify the appropriate order of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> in ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models.</p>
</div>
<div id="sec-tslab-cross-correlation-function-ccf" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Cross-correlation function (CCF)</h3>
<p>Often we are interested in looking for relationships between 2 different time series. There are many ways to do this, but a simple method is via examination of their cross-covariance and cross-correlation.</p>
<p>We begin by defining the sample cross-covariance function (CCVF) in a manner similar to the ACVF, in that</p>
<p><span class="math display" id="eq:CCVF">\[\begin{equation}
\tag{4.14}
g_k^{xy} = \frac{1}{n}\sum_{t=1}^{n-k} \left(y_t-\bar{y}\right) \left(x_{t+k}-\bar{x}\right),
\end{equation}\]</span></p>
<p>but now we are estimating the correlation between a variable <span class="math inline">\(y\)</span> and a <em>different</em> time-shifted variable <span class="math inline">\(x_{t+k}\)</span>. The sample cross-correlation function (CCF) is then defined analogously to the ACF, such that</p>
<p><span class="math display" id="eq:CCF">\[\begin{equation}
\tag{4.15}
r_k^{xy} = \frac{g_k^{xy}}{\sqrt{\text{SD}_x\text{SD}_y}};
\end{equation}\]</span></p>
<p>SD<span class="math inline">\(_x\)</span> and SD<span class="math inline">\(_y\)</span> are the sample standard deviations of <span class="math inline">\(\{x_t\}\)</span> and <span class="math inline">\(\{y_t\}\)</span>, respectively. It is important to re-iterate here that <span class="math inline">\(r_k^{xy} \neq r_{-k}^{xy}\)</span>, but <span class="math inline">\(r_k^{xy} = r_{-k}^{yx}\)</span>. Therefore, it is very important to pay particular attention to which variable you call <span class="math inline">\(y\)</span> (<em>i.e.</em>, the “response”) and which you call <span class="math inline">\(x\)</span> (<em>i.e.</em>, the “predictor”).</p>
<p>As with the ACF, an approximate 95% confidence interval on the CCF can be estimated by</p>
<p><span class="math display" id="eq:CCF95CI">\[\begin{equation}
\tag{4.16}
-\frac{1}{n} \pm \frac{2}{\sqrt{n}}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of data points used in the calculation of the CCF, and the same assumptions apply to its interpretation.</p>
<p>Computing the CCF in R is easy with the function <code>ccf()</code> and it works just like <code>acf()</code>. In fact, <code>ccf()</code> is just a “wrapper” function that calls <code>acf()</code>. As an example, let’s examine the CCF between sunspot activity and number of lynx trapped in Canada as in the classic paper by Moran.</p>
<p>To begin, let’s get the data, which are conveniently included in the <strong>datasets</strong> package included as part of the base installation of R. Before calculating the CCF, however, we need to find the matching years of data. Again, we’ll use the <code>ts.intersect()</code> function.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb237-1"></a><span class="co">## get the matching years of sunspot data</span></span>
<span id="cb237-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb237-2"></a>suns &lt;-<span class="st"> </span><span class="kw">ts.intersect</span>(lynx, sunspot.year)[, <span class="st">&quot;sunspot.year&quot;</span>]</span>
<span id="cb237-3"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb237-3"></a><span class="co">## get the matching lynx data</span></span>
<span id="cb237-4"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb237-4"></a>lynx &lt;-<span class="st"> </span><span class="kw">ts.intersect</span>(lynx, sunspot.year)[, <span class="st">&quot;lynx&quot;</span>]</span></code></pre></div>
<p>Here are plots of the time series.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb238-1"></a><span class="co">## plot time series</span></span>
<span id="cb238-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb238-2"></a><span class="kw">plot</span>(<span class="kw">cbind</span>(suns, lynx), <span class="dt">yax.flip =</span> <span class="ot">TRUE</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotSunsLynx"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotSunsLynx-1.png" alt="Time series of sunspot activity (top) and lynx trappings in Canada (bottom) from 1821-1934." width="80%" />
<p class="caption">
Figure 4.16: Time series of sunspot activity (top) and lynx trappings in Canada (bottom) from 1821-1934.
</p>
</div>
<p>It is important to remember which of the 2 variables you call <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> when calling <code>ccf(x, y, ...)</code>. In this case, it seems most relevant to treat lynx as the <span class="math inline">\(y\)</span> and sunspots as the <span class="math inline">\(x\)</span>, in which case we are mostly interested in the CCF at negative lags (<em>i.e.</em>, when sunspot activity predates inferred lynx abundance). Furthermore, we’ll use log-transformed lynx trappings.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb239-1"></a><span class="co">## CCF of sunspots and lynx</span></span>
<span id="cb239-2"><a href="sec-tslab-correlation-within-and-among-time-series.html#cb239-2"></a><span class="kw">ccf</span>(suns, <span class="kw">log</span>(lynx), <span class="dt">ylab =</span> <span class="st">&quot;Cross-correlation&quot;</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:tslab-plotCCFb"></span>
<img src="Applied_Time_Series_Analysis_files/figure-html/tslab-plotCCFb-1.png" alt="CCF for annual sunspot activity and the log of the number of lynx trappings in Canada from 1821-1934." width="80%" />
<p class="caption">
Figure 4.17: CCF for annual sunspot activity and the log of the number of lynx trappings in Canada from 1821-1934.
</p>
</div>
<p>From Figures <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotSunsLynx">4.16</a> and <a href="sec-tslab-correlation-within-and-among-time-series.html#fig:tslab-plotCCFb">4.17</a> it looks like lynx numbers are relatively low 3-5 years after high sunspot activity (<em>i.e.</em>, significant correlation at lags of -3 to -5).</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-tslab-differencing-to-remove-a-trend-or-seasonal-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-tslab-white-noise-wn.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nwfsc-timeseries/AFTSLabbook/blob/master/cleanedRmd/intro-ts-funcs-lab.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applied_Time_Series_Analysis.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
